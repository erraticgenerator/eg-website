{
    "componentChunkName": "component---src-templates-blog-post-template-js",
    "path": "/blog/vector-boolean-ops-with-html5-canvas/",
    "result": {"data":{"markdownRemark":{"html":"<p><img src=\"/static/demo-f9e5537a3965ec8844c93382cc64c996.gif\" alt=\"Vector boolean operation demo\"></p>\n<p>In this post, I will look at how to handle vector graphics boolean operations such as union, difference, intersection or xor, in the HTML5 Canvas. The boolean operations are very common and useful for any designer. If you regularly use Adobe Illustrator to create graphic elements, you must be familiar with the Pathfinder panel that lets you use these operations.</p>\n<h2>Why vector boolean ops?</h2>\n<p>Let's say you want to get an intersection of two shapes. One way to think about it is from the perspective of bitmap images. You can access individual pixels and create an image mask or use one of the many blend modes (ie. multiply, difference, etc.) This approach certainly works if you mainly work with images, but if your graphics are vector-based, then, handling the intersection with boolean operations, not pixels, will give you back newly created vector shapes, which you can further edit by manipulating individual points or adding a stroke, for example.</p>\n<h2>Using g.js</h2>\n<p>It will be fairly complex to implement by ourselves, so I decided to use a library called g.js. It is a JavaScript graphics library from the Nodebox team, and its simple methods make it very easy to do complex vector graphics operations. I will first show you how to use g.js to create paths and also how to combine the library with another canvas-based library p5.js at the end.</p>\n<p>Let's first set up <code class=\"language-text\">index.html</code> and connect a <code class=\"language-text\">canvas</code> to our script. Then, add the library in the <code class=\"language-text\">head</code>. You can either <a href=\"https://github.com/nodebox/g.js\">download the library</a> or use the CDN as below:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Document<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.rawgit.com/nodebox/g.js/master/dist/g.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>canvas<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#canvas\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      canvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token number\">800</span>\n      canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">500</span>\n  \n  \t  <span class=\"token comment\">// write drawing codes below</span>\n\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><code class=\"language-text\">g.js</code> comes with many primitive shapes such as rect, ellipse, polygon, etc. but here I will only focus on creating a custom path object. To create a new shape or a path, use <code class=\"language-text\">g.Path</code> object.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> pathA <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">g<span class=\"token punctuation\">.</span>Path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>To add points to the path, you can use methods that look very much like the HTML5 Canvas methods.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> pathA <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">g<span class=\"token punctuation\">.</span>Path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">280</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">560</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">curveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">350</span><span class=\"token punctuation\">,</span> <span class=\"token number\">190</span><span class=\"token punctuation\">,</span> <span class=\"token number\">480</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span> <span class=\"token number\">480</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">400</span><span class=\"token punctuation\">)</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">curveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">450</span><span class=\"token punctuation\">,</span> <span class=\"token number\">220</span><span class=\"token punctuation\">,</span> <span class=\"token number\">280</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">280</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">closePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npathA<span class=\"token punctuation\">.</span>stroke <span class=\"token operator\">=</span> <span class=\"token string\">\"teal\"</span><span class=\"token punctuation\">;</span>\npathA<span class=\"token punctuation\">.</span>strokeWidth <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\npathA<span class=\"token punctuation\">.</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\npathA<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style=''>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; '>\n      <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABhUlEQVQoz42SvU4CQRSFlwIbE5GCAiQhIYSCZzDGwgYTKqgNsbI3FmRL194QXoDwALyAFlpgCFERQXZ3htnlRwwLQsEDHDMT3OwCgsXJncxMvtxzz5U6nQ6copQK8TMhBJqmQV9InHXdfv+tTknLF07w52CA8WQMy7KExpMJrNEIzAFbhkrrQIxSqIzhXJZxmEziJJ0WOk6lcJTJoFAugzLmcrMRyG19DYcolEqQJMml60LBBfsXkFAKkzG8E4JIImHDLhUF8/kclJC181sBOsPomSYeazXsBgIC5vX5cFepoN/tQidkJUAX0PnAq6qq+J5OcZHL2d0FIhE81evoGoZwsLFDuzP+kRDMZjPcFouQvF54PB4B3PH7cV+pYNDrCQdbLdPF3AzTxJWirITBdZPPi7XRdB1/rZvdId+tuqbiTJaxFw4jGI3iIB5HMBYTdT8Uwmk2C6Pf3x6KADKGt3YbD9UqXlstvHx84LnZdKnWaEBzBLLVssGYSJEP3lwjfr8JxoE/pbcCmOBDQVwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='A path drawn with g.js methods' title='A path drawn with g.js methods' src='/static/328e645b23fd3be9c8c6b5dd4225b9a2/c1b63/1.png' srcset='/static/328e645b23fd3be9c8c6b5dd4225b9a2/5a46d/1.png 300w,\n/static/328e645b23fd3be9c8c6b5dd4225b9a2/0a47e/1.png 600w,\n/static/328e645b23fd3be9c8c6b5dd4225b9a2/c1b63/1.png 1200w,\n/static/328e645b23fd3be9c8c6b5dd4225b9a2/ddb6a/1.png 1592w' sizes='(max-width: 1200px) 100vw, 1200px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>A path drawn with g.js methods</figcaption>\n  </figure></p>\n<p>You can look at <a href=\"https://github.com/nodebox/g.js/blob/a3a2eead2c8e2641694da2b408a4ac247a8103ac/src/libraries/vg/objects/path.js\">the source code</a> to see what methods are available to use. For drawing a path, you can use <code class=\"language-text\">moveTo()</code>, <code class=\"language-text\">lineTo()</code>, <code class=\"language-text\">curveTo()</code>, <code class=\"language-text\">quadTo()</code>, and <code class=\"language-text\">closePath()</code>.</p>\n<p>Let's draw another shape on top, but this time, instead of using the same methods, I will pass an array of command objects to the <code class=\"language-text\">Path</code> object constructor along with the styling. A command takes a form of an object as below:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"M\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>In the case of a bezier curve, it needs three coordinate values - <code class=\"language-text\">(x,y)</code> defining the actual point location and other values for curve handles:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"C\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">x1</span><span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y1</span><span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">x2</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y2</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">150</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>And here is the code to draw our second path:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> cmds <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n\t<span class=\"token punctuation\">{</span>\n\t  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"M\"</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">180</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span>\n\t  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"L\"</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">680</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span>\n\t  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"C\"</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">x1</span><span class=\"token operator\">:</span> <span class=\"token number\">450</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">y1</span><span class=\"token operator\">:</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">x2</span><span class=\"token operator\">:</span> <span class=\"token number\">550</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">y2</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">550</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span>\n\t  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"L\"</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span>\n\t  <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">180</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span>\n\t  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> pathB <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">g<span class=\"token punctuation\">.</span>Path</span><span class=\"token punctuation\">(</span>cmds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"hotpink\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#ccaaff\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npathB<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style=''>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; '>\n      <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB9klEQVQoz32Ty2sTURSHZ6EggoLuWitoKdX/wJ3SVUXtRo3LQLLwRXVTFTG0oHblSgtSUSgWBMGFtW5EY0UrigFrG+00mbmPmUyioUkwCLoS+slMHs2jcfHjHs6957vnca+hlKJRUspAvi2EwLIs7KoC27br+7W1UUaroxH8PZejWCpSKBQCFUslCqur6AZYK9RohlQOaClJK030WoxDR45yOBRi8GSIgWNDHDx+grtPZ1BKo4SsxiiUrNgtGUqkkkFZ+fwP7jx5hGEYTbrxYBI752J7GuEplCOrcZX4tgz9m4RW6HlN6f4iU6ducn3gHCMHwkxdmuTPpzze6xTZuEnmrYX45nbOMOhHvWwH9XiBteE4jHyAC3E4/5K1yAyEn/F7bB7vRQdg42T9NZ1OUy7/JDp2lT0797IUeQgX5/h7dhZOP+fXrY/YykXkFEpvUHL9mfhgISiXy9yensbYtDno25at27g3NArDryA6i/veQmQ1yv7PUHyoqzWO63J5fLxtGL4mrkzAaAJnzkR4lSnXQE3PJuiZUixZacKxGNt7eujq7WVXfz9dfX3s3refHd3dDJ6J4CWzqDcS4ag2WDNQa5KpFO8SCRZNky8rKywsL6/LNPmc/IqlBVI7VVAHYA3qaE02kyHjOLgbyPerar/WYc0/5R/1IwwWa3woYwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Another path drawn with commands array' title='Another path drawn with commands array' src='/static/fcfbbf40c8aec3b518f6d1cd06ec4917/c1b63/2.png' srcset='/static/fcfbbf40c8aec3b518f6d1cd06ec4917/5a46d/2.png 300w,\n/static/fcfbbf40c8aec3b518f6d1cd06ec4917/0a47e/2.png 600w,\n/static/fcfbbf40c8aec3b518f6d1cd06ec4917/c1b63/2.png 1200w,\n/static/fcfbbf40c8aec3b518f6d1cd06ec4917/ddb6a/2.png 1592w' sizes='(max-width: 1200px) 100vw, 1200px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Another path drawn with commands array</figcaption>\n  </figure></p>\n<h2>Compound Path</h2>\n<p>Continuing with the two paths from above, let's now use <code class=\"language-text\">compound()</code> method to apply boolean operations. This part is very simple thanks to the library.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">g<span class=\"token punctuation\">.</span><span class=\"token function\">compound</span><span class=\"token punctuation\">(</span>firstShape<span class=\"token punctuation\">,</span> secondShape<span class=\"token punctuation\">,</span> method<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Let's try all four compound methods - <code class=\"language-text\">union</code>, <code class=\"language-text\">difference</code>, <code class=\"language-text\">intersection</code> and <code class=\"language-text\">xor</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// comment out the previous drawings</span>\n<span class=\"token comment\">// pathA.draw(ctx);</span>\n<span class=\"token comment\">// pathB.draw(ctx);</span>\n\n<span class=\"token keyword\">let</span> compoundPath<span class=\"token punctuation\">;</span>\n\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath <span class=\"token operator\">=</span> g<span class=\"token punctuation\">.</span><span class=\"token function\">compound</span><span class=\"token punctuation\">(</span>pathA<span class=\"token punctuation\">,</span> pathB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"union\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>stroke <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"yellow\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>strokeWidth <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\ncompoundPath<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath <span class=\"token operator\">=</span> g<span class=\"token punctuation\">.</span><span class=\"token function\">compound</span><span class=\"token punctuation\">(</span>pathA<span class=\"token punctuation\">,</span> pathB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"difference\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>stroke <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"green\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>strokeWidth <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\ncompoundPath<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">restore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">scale</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\ncompoundPath <span class=\"token operator\">=</span> g<span class=\"token punctuation\">.</span><span class=\"token function\">compound</span><span class=\"token punctuation\">(</span>pathA<span class=\"token punctuation\">,</span> pathB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"intersection\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>stroke <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>strokeWidth <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\ncompoundPath<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">translate</span><span class=\"token punctuation\">(</span><span class=\"token number\">600</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath <span class=\"token operator\">=</span> g<span class=\"token punctuation\">.</span><span class=\"token function\">compound</span><span class=\"token punctuation\">(</span>pathA<span class=\"token punctuation\">,</span> pathB<span class=\"token punctuation\">,</span> <span class=\"token string\">\"xor\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>stroke <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"brown\"</span><span class=\"token punctuation\">;</span>\ncompoundPath<span class=\"token punctuation\">.</span>strokeWidth <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\ncompoundPath<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style=''>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; '>\n      <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACP0lEQVQoz3WTvU8UQRiHr7QAe7TxDzBIDPH+A0oLsACxN5CQWGqMhY1ApCV+FBiDiZBg1BADDQUKJ3B3C3t7u3e787Gz94FE/EwoNY/uHsfdRSkm72R+M8/83vedSSmliIeUEqU0QpQplSzK5T18f5MgKLd0qcgVctiuTbaQJWfn0EonWuO8ItXcLKVA64h8fhUT9fLlaw8bGw9wnApaSwIZUDd1Jpcm6brbzZXpNGuba5jQIKRoARswdQyskM2u8O17F5Di8+FlisUxdnY2EVKyX9knk8/weOUJ69Y6taiWwJpZdjhUKhY+IeQUv36nEuCPn2fwvA9IqYlCQ9Fz6H14iYFHA7ieSys72ekwhgVBhGXNcnBwgaOj81RrF8lk7uF5AcYYdu1dhmav0TN1ju77Z7m9eIfD+iGBCJBtfUg1yUIIXDeL6zo4Toli0cP3Q4QI0FrjuA45O89ezmJv12Zn6yOOZaH0KU2Jo9YGpUJM5FOrByglT24OlSas1HgzPc2zvj4WRm+Q3dpChyFSiH8dJrcIRRR5XL8qGRpQVGt+stZ04AvB0swMa/PzvBgZYWF4mHdzc3jlMroJbH+H8eFKRfJqMeDWTQcTHb8AIQijiHKpxMLgIG8nJniaTvN6bAxdryd6R8qt0QDU9xUmKiFEw1lcw4Jt83J8nPl0muf9/cyNjvJ+eRlTrSb1V/91KBvQBki3fojWeI5DYXsb13Eo2nbiNmhrxikOVceG9nlc/DjtJBqTuFbH+kn8C/wDgJIo1TVN8XIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Various compound methods' title='Various compound methods' src='/static/50f73b0b439246e885914607c46c7db5/c1b63/3.png' srcset='/static/50f73b0b439246e885914607c46c7db5/5a46d/3.png 300w,\n/static/50f73b0b439246e885914607c46c7db5/0a47e/3.png 600w,\n/static/50f73b0b439246e885914607c46c7db5/c1b63/3.png 1200w,\n/static/50f73b0b439246e885914607c46c7db5/ddb6a/3.png 1592w' sizes='(max-width: 1200px) 100vw, 1200px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Various compound methods</figcaption>\n  </figure></p>\n<p>As you can see from the image above, we can outline the shape as we need because they are all vector shapes. Another thing to note is that if you <code class=\"language-text\">console.log(compoundPath)</code>, it adds a lot of additional points around the shape and they are all simple <code class=\"language-text\">L</code> or <code class=\"language-text\">lineTo()</code> command. I have not found a way to simplify this resulting points yet.</p>\n<p>In the case of the compound shape from <code class=\"language-text\">difference</code> method on the top-right, you get two resulting shapes (there could be more than two). Is there a way to separate them out as individual shapes? Yes, there is. I am not sure whether or not the library provides a way to do it, but I figured out that I can simply loop through the whole commands array and find the <code class=\"language-text\">Z</code> or <code class=\"language-text\">closePath()</code> command whenever a shape ends. My function looks something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// pass a compoundPath(cPath) to the function</span>\n<span class=\"token comment\">// it returns an array of Path objects</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">separateCompoundPath</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cPath</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> path <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">g<span class=\"token punctuation\">.</span>Path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> cPath<span class=\"token punctuation\">.</span>commands<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    path<span class=\"token punctuation\">.</span>commands<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>cPath<span class=\"token punctuation\">.</span>commands<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cPath<span class=\"token punctuation\">.</span>commands<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      result<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      path <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">g<span class=\"token punctuation\">.</span>Path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Use with p5.js</h2>\n<p>I have only scratched the surface of the very powerful <code class=\"language-text\">g.js</code> library. There are many other objects and functions that will make your vector graphics programming a lot easier, which I have not yet spent enough time with. However, I usually go to <code class=\"language-text\">p5.js</code> library for any Canvas-related sketches, so as a final step, I want to show you how to use <code class=\"language-text\">g.js</code> boolean operations with <code class=\"language-text\">p5.js</code> library.</p>\n<p>The only thing you should know is that by using <code class=\"language-text\">createCanvas()</code>, p5js creates a <code class=\"language-text\">canvas</code> element and its context for you. so, instead of you manually having to connect them, simply use <code class=\"language-text\">drawingContext</code>. The rest is the same.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span><span class=\"token number\">800</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">background</span><span class=\"token punctuation\">(</span><span class=\"token number\">220</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> pathA <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">g<span class=\"token punctuation\">.</span>Path</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">closePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"yellow\"</span><span class=\"token punctuation\">;</span>\n  pathA<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>drawingContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I will wrap this one up by sharing a few links that helped me learn the topic. Hope you have fun!</p>\n<h2>Links</h2>\n<ul>\n<li><a href=\"https://sourceforge.net/p/jsclipper/wiki/documentation/\">JavaScript Clipper library</a>: This library is what <code class=\"language-text\">g.js</code> is using internally for boolean operation.</li>\n<li><a href=\"https://paperjs.org\">Paper.js library</a>: Another very powerful library for vector graphics.</li>\n<li><a href=\"https://g.js.org\">g.js website</a></li>\n<li><a href=\"https://github.com/nodebox/g.js\">g.js Github repo</a></li>\n<li><a href=\"https://github.com/nodebox/g.js/blob/a3a2eead2c8e2641694da2b408a4ac247a8103ac/src/libraries/vg/objects/path.js\">g.js Path object source code</a>: Looking at the source code will give you better ideas on how to use <code class=\"language-text\">g.Path</code> object. Many of the methods were not explained on their official website.</li>\n</ul>","excerpt":"Vector boolean operation demo In this post, I will look at how to handle vector graphics boolean operations such as union, difference…","frontmatter":{"slug":"/blog/vector-boolean-ops-with-html5-canvas/","title":"Vector Boolean Operations with HTML5 Canvas","subtitle":"Adobe Illustrator's Pathfinder, but with JavaScript.","date":"January 19, 2021","tags":["javascript","vector graphics","canvas","gjs"],"featuredImage":{"publicURL":"/static/dfc9317379c49a906dc79d6bfa6ec98e/thumb.png"}}}},"pageContext":{"slug":"/blog/vector-boolean-ops-with-html5-canvas/"}},
    "staticQueryHashes": ["1139398070","1696241065"]}