{"componentChunkName":"component---src-templates-blog-post-template-js","path":"/blog/video-export-from-p5js-sketch/","result":{"data":{"markdownRemark":{"html":"<p>The p5.js library itself does not have a way to export a video out of a sketch but because everything you do is simply drawing on an HTML5 Canvas, if you can find a library to export whatâ€™s on the Canvas, you should be able to use it. I recently stumbled upon a really good and simple library that exports to H.264 mp4 video straight out of a browser (no server needed) and made a simple example to make it work with a p5js sketch.</p>\n<p>If you would rather check out the original library, here is the link, and I will also link to a few other resources at the end of this post.</p>\n<p><a href=\"https://github.com/TrevorSundberg/h264-mp4-encoder\">https://github.com/TrevorSundberg/h264-mp4-encoder</a></p>\n<p>I only spent a little time with the library, but by far, this has been the easiest and most reliable way to export a video out of a p5js sketch. I have tried a few other libraries that will export to either image sequences or .webm videos, but this library directly exports to .mp4 format, which I think is still better supported than .webm, and also supports the current version of p5js (v1.x)</p>\n<p>The example included in the original repo explains everything for general use, but I made two quick examples if you just want to take it and use it in your p5js sketch.</p>\n<h2>Fixed-length Animation Loop</h2>\n<p>The first one is when you have a fixed-length animation. You can first define <code class=\"language-text\">numFrames</code> and play and record the animation. The only difference between a regular p5js sketch and this one is that I created the <code class=\"language-text\">anim()</code> function to replace <code class=\"language-text\">draw()</code> so I can loop it when I want to. You can just treat it like the draw function and do everything you need to inside. The UI is very minimal. If you only want to preview the animation, check the box, <em>preview only</em>. Here is the code:</p>\n<p><div id=\"gist106790163\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-p5js-mp4-export-1-html\" class=\"file my-2\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-html  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c1>&lt;!DOCTYPE html<span class=pl-kos>&gt;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;</span><span class=pl-ent>html</span> <span class=pl-c1>lang</span>=&quot;<span class=pl-s>en</span>&quot;<span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>charset</span>=&quot;<span class=pl-s>UTF-8</span>&quot;<span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>name</span>=&quot;<span class=pl-s>viewport</span>&quot; <span class=pl-c1>content</span>=&quot;<span class=pl-s>width=device-width, initial-scale=1.0</span>&quot;<span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span>Document<span class=pl-kos>&lt;/</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://unpkg.com/h264-mp4-encoder/embuild/dist/h264-mp4-encoder.web.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC9\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>style</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC10\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-ent>html</span> { <span class=pl-c1>font-family</span>: sans-serif; <span class=pl-c1>font-size</span>: <span class=pl-c1>12<span class=pl-smi>px</span></span>; }</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;/</span><span class=pl-ent>style</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;/</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC13\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC15\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c>/*</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            library used: https://github.com/TrevorSundberg/h264-mp4-encoder </span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC17\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            </span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC18\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            a simple example exporting mp4 with p5js.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC19\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            custom animation loop, not using draw(), fixed-length animation.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>        */</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC21\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>cwidth</span> <span class=pl-c1>=</span> <span class=pl-c1>640</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC22\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>cheight</span> <span class=pl-c1>=</span> <span class=pl-c1>360</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC23\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>button</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC24\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>checkbox</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC25\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC26\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>const</span> <span class=pl-s1>frate</span> <span class=pl-c1>=</span> <span class=pl-c1>30</span> <span class=pl-c>// frame rate</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC27\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>const</span> <span class=pl-s1>numFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>100</span> <span class=pl-c>// num of frames to record</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC28\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>true</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC29\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC30\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>function</span> <span class=pl-en>setup</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC31\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>createCanvas</span><span class=pl-kos>(</span><span class=pl-s1>cwidth</span><span class=pl-kos>,</span> <span class=pl-s1>cheight</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC32\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>frameRate</span><span class=pl-kos>(</span><span class=pl-s1>frate</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC33\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>button</span> <span class=pl-c1>=</span> <span class=pl-en>createButton</span><span class=pl-kos>(</span><span class=pl-s>&#39;record&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC34\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>button</span><span class=pl-kos>.</span><span class=pl-en>mousePressed</span><span class=pl-kos>(</span><span class=pl-s1>record</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC35\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>checkbox</span> <span class=pl-c1>=</span> <span class=pl-en>createCheckbox</span><span class=pl-kos>(</span><span class=pl-s>&#39; preview only&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC36\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>checkbox</span><span class=pl-kos>.</span><span class=pl-en>style</span><span class=pl-kos>(</span><span class=pl-s>&#39;display&#39;</span><span class=pl-kos>,</span> <span class=pl-s>&#39;inline&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC37\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>checkbox</span><span class=pl-kos>.</span><span class=pl-en>changed</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC38\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>recording</span> <span class=pl-c1>=</span> !<span class=pl-s1>recording</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC39\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC40\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>anim</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>)</span> <span class=pl-c>// display first frame</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC41\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC42\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC43\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>function</span> <span class=pl-en>anim</span><span class=pl-kos>(</span><span class=pl-s1>count</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC44\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>background</span><span class=pl-kos>(</span><span class=pl-c1>220</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC45\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>textSize</span><span class=pl-kos>(</span><span class=pl-c1>128</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC46\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>textAlign</span><span class=pl-kos>(</span><span class=pl-c1>CENTER</span><span class=pl-kos>,</span> <span class=pl-c1>CENTER</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC47\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>text</span><span class=pl-kos>(</span><span class=pl-s1>count</span><span class=pl-kos>,</span> <span class=pl-s1>width</span> / <span class=pl-c1>2</span><span class=pl-kos>,</span> <span class=pl-s1>height</span> / <span class=pl-c1>2</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC48\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC49\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC50\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>function</span> <span class=pl-en>record</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC51\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-c1>HME</span><span class=pl-kos>.</span><span class=pl-en>createH264MP4Encoder</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-k>async</span> <span class=pl-s1>encoder</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC52\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span> <span class=pl-c1>=</span> <span class=pl-s>&#39;test&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC53\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>width</span> <span class=pl-c1>=</span> <span class=pl-s1>cwidth</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC54\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>height</span> <span class=pl-c1>=</span> <span class=pl-s1>cheight</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC55\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>frameRate</span> <span class=pl-c1>=</span> <span class=pl-s1>frate</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC56\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>kbps</span> <span class=pl-c1>=</span> <span class=pl-c1>50000</span> <span class=pl-c>// video quality</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC57\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>groupOfPictures</span> <span class=pl-c1>=</span> <span class=pl-c1>10</span> <span class=pl-c>// lower if you have fast actions.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC58\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>initialize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L59\" class=\"blob-num js-line-number\" data-line-number=\"59\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC59\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L60\" class=\"blob-num js-line-number\" data-line-number=\"60\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC60\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-k>for</span> <span class=pl-kos>(</span><span class=pl-k>let</span> <span class=pl-s1>i</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span><span class=pl-kos>;</span> <span class=pl-s1>i</span> <span class=pl-c1>&lt;</span> <span class=pl-s1>numFrames</span><span class=pl-kos>;</span> <span class=pl-s1>i</span><span class=pl-c1>++</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L61\" class=\"blob-num js-line-number\" data-line-number=\"61\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC61\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-en>anim</span><span class=pl-kos>(</span><span class=pl-s1>i</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L62\" class=\"blob-num js-line-number\" data-line-number=\"62\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC62\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>addFrameRgba</span><span class=pl-kos>(</span><span class=pl-s1>drawingContext</span><span class=pl-kos>.</span><span class=pl-en>getImageData</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-s1>canvas</span><span class=pl-kos>.</span><span class=pl-c1>width</span><span class=pl-kos>,</span> <span class=pl-s1>canvas</span><span class=pl-kos>.</span><span class=pl-c1>height</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-c1>data</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L63\" class=\"blob-num js-line-number\" data-line-number=\"63\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC63\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-k>await</span> <span class=pl-k>new</span> <span class=pl-v>Promise</span><span class=pl-kos>(</span><span class=pl-s1>resolve</span> <span class=pl-c1>=&gt;</span> <span class=pl-smi>window</span><span class=pl-kos>.</span><span class=pl-en>requestAnimationFrame</span><span class=pl-kos>(</span><span class=pl-s1>resolve</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L64\" class=\"blob-num js-line-number\" data-line-number=\"64\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC64\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L65\" class=\"blob-num js-line-number\" data-line-number=\"65\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC65\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L66\" class=\"blob-num js-line-number\" data-line-number=\"66\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC66\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>finalize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L67\" class=\"blob-num js-line-number\" data-line-number=\"67\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC67\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>recording</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L68\" class=\"blob-num js-line-number\" data-line-number=\"68\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC68\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-k>const</span> <span class=pl-s1>uint8Array</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>FS</span><span class=pl-kos>.</span><span class=pl-en>readFile</span><span class=pl-kos>(</span><span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L69\" class=\"blob-num js-line-number\" data-line-number=\"69\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC69\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-k>const</span> <span class=pl-s1>anchor</span> <span class=pl-c1>=</span> <span class=pl-smi>document</span><span class=pl-kos>.</span><span class=pl-en>createElement</span><span class=pl-kos>(</span><span class=pl-s>&#39;a&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L70\" class=\"blob-num js-line-number\" data-line-number=\"70\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC70\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>href</span> <span class=pl-c1>=</span> <span class=pl-c1>URL</span><span class=pl-kos>.</span><span class=pl-en>createObjectURL</span><span class=pl-kos>(</span><span class=pl-k>new</span> <span class=pl-v>Blob</span><span class=pl-kos>(</span><span class=pl-kos>[</span><span class=pl-s1>uint8Array</span><span class=pl-kos>]</span><span class=pl-kos>,</span> <span class=pl-kos>{</span> <span class=pl-c1>type</span>: <span class=pl-s>&#39;video/mp4&#39;</span> <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L71\" class=\"blob-num js-line-number\" data-line-number=\"71\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC71\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>download</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L72\" class=\"blob-num js-line-number\" data-line-number=\"72\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC72\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-en>click</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L73\" class=\"blob-num js-line-number\" data-line-number=\"73\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC73\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L74\" class=\"blob-num js-line-number\" data-line-number=\"74\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC74\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>delete</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L75\" class=\"blob-num js-line-number\" data-line-number=\"75\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC75\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L76\" class=\"blob-num js-line-number\" data-line-number=\"76\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC76\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L77\" class=\"blob-num js-line-number\" data-line-number=\"77\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC77\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L78\" class=\"blob-num js-line-number\" data-line-number=\"78\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC78\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;/</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-1-html-L79\" class=\"blob-num js-line-number\" data-line-number=\"79\"></td>\n        <td id=\"file-p5js-mp4-export-1-html-LC79\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;/</span><span class=pl-ent>html</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/erraticgenerator/aef25bc40b0bda91690c7f3d150c61e7/raw/13e7f990279e3632ca127d11f203a35bec16f53e/p5js-mp4-export-1.html\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/erraticgenerator/aef25bc40b0bda91690c7f3d150c61e7#file-p5js-mp4-export-1-html\">p5js-mp4-export-1.html</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>Within the Regular Draw Loop</h2>\n<p>The second example is when you want to record a video while the animation is being played. It wonâ€™t loop but will just capture the frames as it plays.</p>\n<p><div id=\"gist106790422\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-p5js-mp4-export-2-html\" class=\"file my-2\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-html  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c1>&lt;!DOCTYPE html<span class=pl-kos>&gt;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;</span><span class=pl-ent>html</span> <span class=pl-c1>lang</span>=&quot;<span class=pl-s>en</span>&quot;<span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC5\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>charset</span>=&quot;<span class=pl-s>UTF-8</span>&quot;<span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>name</span>=&quot;<span class=pl-s>viewport</span>&quot; <span class=pl-c1>content</span>=&quot;<span class=pl-s>width=device-width, initial-scale=1.0</span>&quot;<span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span>Document<span class=pl-kos>&lt;/</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://unpkg.com/h264-mp4-encoder/embuild/dist/h264-mp4-encoder.web.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC9\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;/</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC13\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC14\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c>/*</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC15\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            library used: https://github.com/TrevorSundberg/h264-mp4-encoder </span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            </span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC17\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            a simple example exporting mp4 with p5js.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC18\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>            record video while animation is being played.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC19\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-c>        */</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC20\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>cwidth</span> <span class=pl-c1>=</span> <span class=pl-c1>640</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC21\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>cheight</span> <span class=pl-c1>=</span> <span class=pl-c1>360</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC22\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>button</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC23\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC24\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>encoder</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC25\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC26\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>const</span> <span class=pl-s1>frate</span> <span class=pl-c1>=</span> <span class=pl-c1>30</span> <span class=pl-c>// frame rate</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC27\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>const</span> <span class=pl-s1>numFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>100</span> <span class=pl-c>// num of frames to record</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC28\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>false</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC29\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>recordedFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC30\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC31\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>let</span> <span class=pl-s1>count</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC32\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC33\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-c>// make sure encoder is ready before use</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC34\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>function</span> <span class=pl-en>preload</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC35\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-c1>HME</span><span class=pl-kos>.</span><span class=pl-en>createH264MP4Encoder</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-s1>enc</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC36\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span> <span class=pl-c1>=</span> <span class=pl-s1>enc</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC37\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span> <span class=pl-c1>=</span> <span class=pl-s>&#39;test&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC38\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>width</span> <span class=pl-c1>=</span> <span class=pl-s1>cwidth</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC39\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>height</span> <span class=pl-c1>=</span> <span class=pl-s1>cheight</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC40\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>frameRate</span> <span class=pl-c1>=</span> <span class=pl-s1>frate</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC41\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>kbps</span> <span class=pl-c1>=</span> <span class=pl-c1>50000</span> <span class=pl-c>// video quality</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC42\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>groupOfPictures</span> <span class=pl-c1>=</span> <span class=pl-c1>10</span> <span class=pl-c>// lower if you have fast actions.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC43\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>initialize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC44\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-kos>}</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC45\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC46\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC47\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>function</span> <span class=pl-en>setup</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC48\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>createCanvas</span><span class=pl-kos>(</span><span class=pl-s1>cwidth</span><span class=pl-kos>,</span> <span class=pl-s1>cheight</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC49\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>frameRate</span><span class=pl-kos>(</span><span class=pl-s1>frate</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC50\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>button</span> <span class=pl-c1>=</span> <span class=pl-en>createButton</span><span class=pl-kos>(</span><span class=pl-s>&#39;record&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC51\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>button</span><span class=pl-kos>.</span><span class=pl-en>mousePressed</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>true</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC52\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC53\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC54\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-k>function</span> <span class=pl-en>draw</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC55\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>background</span><span class=pl-kos>(</span><span class=pl-c1>220</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC56\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>textSize</span><span class=pl-kos>(</span><span class=pl-c1>128</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC57\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>textAlign</span><span class=pl-kos>(</span><span class=pl-c1>CENTER</span><span class=pl-kos>,</span> <span class=pl-c1>CENTER</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC58\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-en>text</span><span class=pl-kos>(</span><span class=pl-s1>count</span><span class=pl-kos>,</span> <span class=pl-s1>width</span> / <span class=pl-c1>2</span><span class=pl-kos>,</span> <span class=pl-s1>height</span> / <span class=pl-c1>2</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L59\" class=\"blob-num js-line-number\" data-line-number=\"59\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC59\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-s1>count</span><span class=pl-c1>++</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L60\" class=\"blob-num js-line-number\" data-line-number=\"60\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC60\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L61\" class=\"blob-num js-line-number\" data-line-number=\"61\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC61\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-c>// keep adding new frame</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L62\" class=\"blob-num js-line-number\" data-line-number=\"62\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC62\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>recording</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L63\" class=\"blob-num js-line-number\" data-line-number=\"63\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC63\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-smi>console</span><span class=pl-kos>.</span><span class=pl-en>log</span><span class=pl-kos>(</span><span class=pl-s>&#39;recording&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L64\" class=\"blob-num js-line-number\" data-line-number=\"64\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC64\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>addFrameRgba</span><span class=pl-kos>(</span><span class=pl-s1>drawingContext</span><span class=pl-kos>.</span><span class=pl-en>getImageData</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>width</span><span class=pl-kos>,</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>height</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-c1>data</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L65\" class=\"blob-num js-line-number\" data-line-number=\"65\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC65\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>recordedFrames</span><span class=pl-c1>++</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L66\" class=\"blob-num js-line-number\" data-line-number=\"66\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC66\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L67\" class=\"blob-num js-line-number\" data-line-number=\"67\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC67\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-c>// finalize encoding and export as mp4</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L68\" class=\"blob-num js-line-number\" data-line-number=\"68\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC68\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>recordedFrames</span> <span class=pl-c1>===</span> <span class=pl-s1>numFrames</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L69\" class=\"blob-num js-line-number\" data-line-number=\"69\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC69\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>false</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L70\" class=\"blob-num js-line-number\" data-line-number=\"70\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC70\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>recordedFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L71\" class=\"blob-num js-line-number\" data-line-number=\"71\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC71\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-smi>console</span><span class=pl-kos>.</span><span class=pl-en>log</span><span class=pl-kos>(</span><span class=pl-s>&#39;recording stopped&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L72\" class=\"blob-num js-line-number\" data-line-number=\"72\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC72\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L73\" class=\"blob-num js-line-number\" data-line-number=\"73\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC73\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>finalize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L74\" class=\"blob-num js-line-number\" data-line-number=\"74\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC74\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-k>const</span> <span class=pl-s1>uint8Array</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>FS</span><span class=pl-kos>.</span><span class=pl-en>readFile</span><span class=pl-kos>(</span><span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L75\" class=\"blob-num js-line-number\" data-line-number=\"75\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC75\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-k>const</span> <span class=pl-s1>anchor</span> <span class=pl-c1>=</span> <span class=pl-smi>document</span><span class=pl-kos>.</span><span class=pl-en>createElement</span><span class=pl-kos>(</span><span class=pl-s>&#39;a&#39;</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L76\" class=\"blob-num js-line-number\" data-line-number=\"76\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC76\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>href</span> <span class=pl-c1>=</span> <span class=pl-c1>URL</span><span class=pl-kos>.</span><span class=pl-en>createObjectURL</span><span class=pl-kos>(</span><span class=pl-k>new</span> <span class=pl-v>Blob</span><span class=pl-kos>(</span><span class=pl-kos>[</span><span class=pl-s1>uint8Array</span><span class=pl-kos>]</span><span class=pl-kos>,</span> <span class=pl-kos>{</span> <span class=pl-c1>type</span>: <span class=pl-s>&#39;video/mp4&#39;</span> <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L77\" class=\"blob-num js-line-number\" data-line-number=\"77\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC77\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>download</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L78\" class=\"blob-num js-line-number\" data-line-number=\"78\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC78\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-en>click</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L79\" class=\"blob-num js-line-number\" data-line-number=\"79\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC79\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>delete</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L80\" class=\"blob-num js-line-number\" data-line-number=\"80\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC80\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L81\" class=\"blob-num js-line-number\" data-line-number=\"81\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC81\" class=\"blob-code blob-code-inner js-file-line\">                <span class=pl-en>preload</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-c>// reinitialize encoder</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L82\" class=\"blob-num js-line-number\" data-line-number=\"82\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC82\" class=\"blob-code blob-code-inner js-file-line\">            <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L83\" class=\"blob-num js-line-number\" data-line-number=\"83\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC83\" class=\"blob-code blob-code-inner js-file-line\">        <span class=pl-kos>}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L84\" class=\"blob-num js-line-number\" data-line-number=\"84\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC84\" class=\"blob-code blob-code-inner js-file-line\">    <span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L85\" class=\"blob-num js-line-number\" data-line-number=\"85\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC85\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;/</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L86\" class=\"blob-num js-line-number\" data-line-number=\"86\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC86\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-p5js-mp4-export-2-html-L87\" class=\"blob-num js-line-number\" data-line-number=\"87\"></td>\n        <td id=\"file-p5js-mp4-export-2-html-LC87\" class=\"blob-code blob-code-inner js-file-line\"><span class=pl-kos>&lt;/</span><span class=pl-ent>html</span><span class=pl-kos>&gt;</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/erraticgenerator/4e416428c1f04063ab6958afae11ff7b/raw/d0955c8b142275d218e717389d988bbd0c1d9138/p5js-mp4-export-2.html\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/erraticgenerator/4e416428c1f04063ab6958afae11ff7b#file-p5js-mp4-export-2-html\">p5js-mp4-export-2.html</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>Itâ€™s just amazing to think about how much a web browser can do these days. And thanks to people who generously share these libraries, I can have more fun with coding. Here are some resources that I found useful:</p>\n<ul>\n<li>The original repo: <a href=\"https://github.com/TrevorSundberg/h264-mp4-encoder\">https://github.com/TrevorSundberg/h264-mp4-encoder</a></li>\n<li>Mattdeslâ€™s fork: <a href=\"https://github.com/mattdesl/h264-mp4-encoder\">https://github.com/mattdesl/h264-mp4-encoder</a> (I havenâ€™t tried but it says it will be faster than the original)</li>\n<li>An Observable notebook: <a href=\"https://observablehq.com/@rreusser/h264-mp4-encoder\">https://observablehq.com/@rreusser/h264-mp4-encoder</a></li>\n</ul>","excerpt":"The p5.js library itself does not have a way to export a video out of a sketch but because everything you do is simply drawing on an HTMLâ€¦","frontmatter":{"slug":"/blog/video-export-from-p5js-sketch/","title":"Video Export from p5.js Sketch","subtitle":"Save mp4 videos from within a browser. No server needed.","date":"December 05, 2020","tags":["javascript","p5js","creative coding","canvas","html5"],"featuredImage":null}}},"pageContext":{"slug":"/blog/video-export-from-p5js-sketch/"}},"staticQueryHashes":["1696241065","3380088787"]}