<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="twitter:image" content="https://erraticgenerator.com/static/e44c442f1eb0ce6a4808fe237eda03af/thumb.png"/><meta data-react-helmet="true" name="twitter:description" content="Gatsbyjs and Mapbox GL JS I love making websites with Gatsbyjs and recently started using Mapbox, so I thought I could combine the two. The…"/><meta data-react-helmet="true" name="twitter:title" content="Gatsby Blog With Mapbox GL JS Using React Hooks"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="og:image" content="https://erraticgenerator.com/static/e44c442f1eb0ce6a4808fe237eda03af/thumb.png"/><meta data-react-helmet="true" property="og:description" content="Gatsbyjs and Mapbox GL JS I love making websites with Gatsbyjs and recently started using Mapbox, so I thought I could combine the two. The…"/><meta data-react-helmet="true" property="og:title" content="Gatsby Blog With Mapbox GL JS Using React Hooks"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:url" content="https://erraticgenerator.com/blog/gatsby-blog-with-mapbox-gl-js-using-react-hooks/"/><meta data-react-helmet="true" name="image" content="https://erraticgenerator.com/static/e44c442f1eb0ce6a4808fe237eda03af/thumb.png"/><meta data-react-helmet="true" name="description" content="Gatsbyjs and Mapbox GL JS I love making websites with Gatsbyjs and recently started using Mapbox, so I thought I could combine the two. The…"/><meta name="generator" content="Gatsby 4.10.3"/><style data-href="/styles.263cc77e36b0087b6e1e.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#073642}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{background:#eee8d5;color:#657b83}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}body .gist .highlight{background:#fdf6e3}body .gist .blob-code-inner,body .gist .blob-num,body .gist .pl-s1 .pl-s2,body .gist .pl-smi,body .gist .pl-smp,body .gist .pl-stj,body .gist .pl-vo,body .gist .pl-vpf{color:#657b83}body .gist .pl-c,body .gist .pl-c span{color:#93a1a1;font-style:italic}body .gist .pl-mb{color:#2aa198;font-weight:700}body .gist .pl-mh .pl-en{color:#cb4b16;font-weight:700}body .gist .pl-mi{color:#859900;font-style:italic}body .gist .pl-c1,body .gist .pl-pds,body .gist .pl-s1,body .gist .pl-s1 .pl-pse .pl-s2,body .gist .pl-sv{color:#2aa198}body .gist .pl-e,body .gist .pl-en,body .gist .pl-ent,body .gist .pl-s,body .gist .pl-v{color:#268bd2}body .gist .pl-k,body .gist .pl-mdh,body .gist .pl-mdr,body .gist .pl-ml,body .gist .pl-mm,body .gist .pl-mo,body .gist .pl-mp,body .gist .pl-mr,body .gist .pl-ms,body .gist .pl-s1 .pl-v,body .gist .pl-s3{color:#859900}body .gist .pl-mh,body .gist .pl-sc,body .gist .pl-sr .pl-cce{color:#cb4b16}body .gist .highlight-source-css .pl-k,body .gist .pl-mq{color:#93a1a1}body .gist .pl-sr,body .gist .pl-sr .pl-sra,body .gist .pl-sr .pl-sre,body .gist .pl-src{color:#d30102}body .gist .highlight-source-c\+\+ .pl-s,body .gist .pl-st{color:#dc322f}body .gist .pl-mdht,body .gist .pl-mi1{background:rgba(0,64,0,.5);color:#657b83}body .gist .pl-id,body .gist .pl-ii,body .gist .pl-md,body .gist .pl-mdhf{background:rgba(64,0,0,.5);color:#657b83}</style><title data-react-helmet="true">Gatsby Blog With Mapbox GL JS Using React Hooks | ErraticGenerator.com</title><link href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css" rel="stylesheet"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-ceba9cd646c3ad263f69.js"/><link as="script" rel="preload" href="/framework-68cf14eef5bda77f0f65.js"/><link as="script" rel="preload" href="/app-45d7508fd8245f182e57.js"/><link as="script" rel="preload" href="/commons-a19e32fc4bdcf911055e.js"/><link as="script" rel="preload" href="/eb9d8cad3e7a5281726e7c4ed76f1fbad1e5b719-6acf9f4f59ccff7436a6.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-template-js-478bf50e9978849b5b40.js"/><link as="fetch" rel="preload" href="/page-data/blog/gatsby-blog-with-mapbox-gl-js-using-react-hooks/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1139398070.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1696241065.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 1j3ddox">.css-1j3ddox{height:100%;display:grid;grid-template-columns:100%;grid-template-rows:120px auto 100px;}.css-1j3ddox p{margin-bottom:2.4rem;font-size:1.8rem;line-height:1.6;}</style><div class="css-1j3ddox"><style data-emotion="css-global 1k9w1ix">@import url("https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap");*{margin:0;box-sizing:border-box;}html,body{font-family:"Raleway",sans-serif;font-size:10px;height:100%;}a{color:black;-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css yepcm5">.css-yepcm5{grid-row:1/2;}</style><style data-emotion="css 8souqa">.css-8souqa{margin-bottom:48px;padding:12px 0;height:120px;background-image:linear-gradient(#fdd 0%, white 100%);}</style><header class="css-8souqa"><style data-emotion="css 1v2sh8t">.css-1v2sh8t{margin:0 auto;padding:0 12px;max-width:800px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-1v2sh8t"><style data-emotion="css 16xc8z8">.css-16xc8z8{-webkit-flex:4;-ms-flex:4;flex:4;}@media (max-width: 600px){.css-16xc8z8{-webkit-flex:6;-ms-flex:6;flex:6;}}</style><div class="css-16xc8z8"><style data-emotion="css 1j389vi">.css-1j389vi{font-weight:700;}</style><h1 class="css-1j389vi"><a href="/">Erratic Generator</a></h1><style data-emotion="css mmvz9h">.css-mmvz9h{font-weight:400;}</style><h2 class="css-mmvz9h">Creative Coding and Design</h2></div><style data-emotion="css 5a1ead">.css-5a1ead{-webkit-flex:1;-ms-flex:1;flex:1;font-size:1.6rem;}</style><a class="css-5a1ead" href="/about/">About</a></div></header><style data-emotion="css v2h3ik">.css-v2h3ik{max-width:800px;width:100%;margin:0 auto;padding:0 12px;grid-row:2/3;}</style><main class="css-v2h3ik"><div class="css-0"><style data-emotion="css nyfdx3">.css-nyfdx3{margin-bottom:3rem;}</style><header class="css-nyfdx3"><style data-emotion="css 10d63d4">.css-10d63d4{margin-top:1rem;font-size:4rem;line-height:1.2;}</style><h1 class="css-10d63d4">Gatsby Blog With Mapbox GL JS Using React Hooks</h1><style data-emotion="css 5ezmz0">.css-5ezmz0{margin-bottom:0.6rem;color:#666;font-size:2.4rem;font-weight:400;}</style><h2 class="css-5ezmz0">With smooth map animation between pages</h2><style data-emotion="css 1dqoxsa">.css-1dqoxsa{color:#666;font-size:1.8rem;}</style><time class="css-1dqoxsa">December 27, 2020</time></header><style data-emotion="css e9foim">.css-e9foim h2{margin-bottom:0.8rem;font-family:"Open Sans",sans-serif;font-size:2.4rem;}.css-e9foim p{margin-bottom:2.4rem;font-size:1.8rem;line-height:1.6;}.css-e9foim a{color:teal;-webkit-text-decoration:underline;text-decoration:underline;}.css-e9foim ul{margin-bottom:2.4rem;font-size:1.8rem;}.css-e9foim li{line-height:1.6;}.css-e9foim figure{margin:5rem auto;width:100%;}.css-e9foim .gatsby-resp-image-wrapper{max-width:100%!important;}.css-e9foim figure img{width:100%;}.css-e9foim figure figcaption{padding:0.6rem 4%;color:#666;font-size:1.6rem;text-align:center;}.css-e9foim .gist,.css-e9foim .gatsby-highlight{margin:5rem auto;}.css-e9foim .gist .gist-file{border:none;}.css-e9foim .gatsby-highlight,.css-e9foim .gist span{font-size:1.4rem;}</style><div class="css-e9foim"><p><img src="/static/demo-dca31bf5e3765021fb1e85a50deb1a69.gif" alt="Gatsbyjs and Mapbox GL JS"></p>
<p>I love making websites with Gatsbyjs and recently started using Mapbox, so I thought I could combine the two. The idea is to create a travel blog (of course, traveling after the virus goes away) where the map will support the text content by dynamically zooming into the area of interest and putting markers of the places from a blog post. When navigating between different posts, the map will continuously highlight the new areas instead of refreshing the whole map each time. This will give a better spatial context to the readers.</p>
<p>Before I dive in, I just want to let you know that I am still learning React and this post is the documentation of my learning process. I will do my best to highlight some mistakes and key findings I made through the process but if you have any suggestions on better ways of doing things, please let me know. It was a really great exercise for me to get familiar with Gatsby and Mabpx GL JS API as well as using React hooks with functional components.</p>
<h2>Setup</h2>
<p>I will not go over every single detail or every single line of code but I will include <a href="https://github.com/erraticgenerator/gatsby-mapbox-blog">my Github repo</a> if you want to try it out yourself. I also assume you have a basic familiarity with Gatsby and React, and have installed the basic dependencies to make Gatsby working.</p>
<p>First thing to do is to create an empty Gatsby project. I will use one of their basic starters just so I don't have to create and configure everything, but we will delete almost all the files that come with it so we can only focus on working with the Mapbox map. We will create a bare bone structure, which you can adapt to your own needs.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ gatsby new gatsby-mapbox-blog</code></pre></div>
<p>After creating the project, <code class="language-text">cd</code> into it and run <code class="language-text">gatsby develop</code>, and you will see this screen:</p>
<p><figure class='gatsby-resp-image-figure' style=''>
    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; '>
      <span class='gatsby-resp-image-background-image' style="padding-bottom: 52.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0UlEQVQoz51RuwrCQBDMZ/oorQX1E9TKTtQfsDUWFmI6LfwDOwut5IiGBEwumsfdyAVyXKJBz4Vh72Z3h1nWGDRMSNRNDJtLjNtrTDobTLsWZj0Lo9YK/doChd4KGPgQN8eGfSUAOHTD4IxDgOU5ZaA0BH2ECPxQ8r/C4JxDhQiWxHDOBIftCUnMMq7cVwW5sioYBRT7+Q7kSN5qX1dWP9Ih47gcXSRRWuC1BFUxz2Xw72n2FocRJW2H+YDIlD7heRHiGP87rBrUEat0WL66jsMXQkv8FKcOZDoAAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class='gatsby-resp-image-image' alt='A screenshot of Gatsby default starter' title='A screenshot of Gatsby default starter' src='/static/526c783f1f318465d346c8cb7e9a49a0/c1b63/gatsby-default-starter.png' srcset='/static/526c783f1f318465d346c8cb7e9a49a0/5a46d/gatsby-default-starter.png 300w,
/static/526c783f1f318465d346c8cb7e9a49a0/0a47e/gatsby-default-starter.png 600w,
/static/526c783f1f318465d346c8cb7e9a49a0/c1b63/gatsby-default-starter.png 1200w,
/static/526c783f1f318465d346c8cb7e9a49a0/d61c2/gatsby-default-starter.png 1800w,
/static/526c783f1f318465d346c8cb7e9a49a0/f33fc/gatsby-default-starter.png 1905w' sizes='(max-width: 1200px) 100vw, 1200px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>
    </span>
    <figcaption class='gatsby-resp-image-figcaption'>A screenshot of Gatsby default starter</figcaption>
  </figure></p>
<p>Let's delete almost all the files in the <code class="language-text">src</code> folder except <code class="language-text">components/layout.js</code>, <code class="language-text">pages/404.js</code> and <code class="language-text">pages/index.js</code>. After deleting, it will complain about missing files, so we will also need to clean up each file and remove any unnecessary components and html codes from them. (If you have experience with Gatsby, you can either leave them be or add them back later.)</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// index.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> Layout <span class="token keyword">from</span> <span class="token string">"../components/layout"</span>

<span class="token keyword">const</span> <span class="token function-variable function">IndexPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Layout</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">My Travel Blog</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Layout</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage</code></pre></div>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// layout.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span>

<span class="token keyword">const</span> <span class="token function-variable function">Layout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

Layout<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>node<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Layout</code></pre></div>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// 404.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>

<span class="token keyword">const</span> <span class="token function-variable function">NotFoundPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Page Not Found</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> NotFoundPage</code></pre></div>
<p>One more thing I did was to clean up <code class="language-text">gatsby-config.js</code> Again, I wanted to start with a bare minimum, so I removed a lot of stuff, and also changed the file source path to <code class="language-text">content</code> so be sure to create a folder named <code class="language-text">content</code> in the root of your project. We don't need it right now, but this is where I will be creating Markdown files for blog posts later.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">siteMetadata</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Gatsby Mapbox Blog</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">author</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Erratic Generator</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gatsby-plugin-react-helmet</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gatsby-source-filesystem</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">content</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/content</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gatsby-transformer-sharp</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gatsby-plugin-sharp</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>It's probably a good idea to restart your development server at this point just to make sure there is no error. Run <code class="language-text">gatsby develop</code> again and if you don't see any error messages, you are good to move to the next step.</p>
<h2>Install Mapbox</h2>
<p>We will install Mapbox GL JS from NPM. There are a few Mapbox wrapper projects, that give you many React components to use, and I have tried one but I felt a bit difficult to customize (due to my lack of understanding, not the fault of the library), and Mapbox has a lot of official code examples based on vanilla JS so I thought I would give some time to learn to combine vanilla JS and React components myself.</p>
<p>You can follow <a href="https://www.mapbox.com/install/js/">their guide</a> but basically, you only need to run this command in the terminal:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> mapbox-gl --save</code></pre></div>
<p><em>Note: The current verion of <code class="language-text">mapbox-gl</code> is <code class="language-text">2.0.1</code> at the time of writing. It worked fine for development, but I had an error when deploying to a demo website. I downgraded and used <code class="language-text">1.13.0</code> and the problem disappeared.</em></p>
<p>It also needs a stylesheet to display the map properly. You can include this CSS in the <code class="language-text">&lt;head></code> of any HTML page using a map, but I will later add it in my component by directly importing from the npm module. It's up to you.</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>https://api.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.css<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span></code></pre></div>
<h2>Display The Map</h2>
<p>I want the same map to be shared across multiple blog posts, so instead of adding a map on every page, I will instead add it the the <code class="language-text">Layout</code> component, because every page that I will be creating will be wrapped with the component. And to keep the code clean and reusable, I will make a separate component called <code class="language-text">Map</code>. Let's create <code class="language-text">components/map.js</code>.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// map.js</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> mapboxgl <span class="token keyword">from</span> <span class="token string">"mapbox-gl"</span>
<span class="token keyword">import</span> <span class="token string">"mapbox-gl/dist/mapbox-gl.css"</span>

<span class="token keyword">const</span> <span class="token constant">MAPBOX_TOKEN</span> <span class="token operator">=</span> <span class="token string">"use-your-own-token"</span>

<span class="token keyword">const</span> mapContainerStyle <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token string">"100%"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">"120px"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">Map</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mapContainerRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>map<span class="token punctuation">,</span> setMap<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">container</span><span class="token operator">:</span> mapContainerRef<span class="token punctuation">.</span>current<span class="token punctuation">,</span>
      <span class="token literal-property property">accessToken</span><span class="token operator">:</span> <span class="token constant">MAPBOX_TOKEN</span><span class="token punctuation">,</span>
      <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">"mapbox://styles/mapbox/streets-v11"</span><span class="token punctuation">,</span>
      <span class="token comment">// Empire State Building [lng, lat]</span>
      <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">73.9856</span><span class="token punctuation">,</span> <span class="token number">40.7497</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    map<span class="token punctuation">.</span><span class="token function">addControl</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>NavigationControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"top-right"</span><span class="token punctuation">)</span>

    <span class="token function">setMap</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mapContainerRef<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mapContainerStyle<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Map
</code></pre></div>
<p>And include a Map component in <code class="language-text">layout.js</code></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// layout.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span>
<span class="token keyword">import</span> Map <span class="token keyword">from</span> <span class="token string">"./map"</span>

<span class="token keyword">const</span> <span class="token function-variable function">Layout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Map <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>main<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

Layout<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>node<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Layout</code></pre></div>
<p><figure class='gatsby-resp-image-figure' style=''>
    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1072px; '>
      <span class='gatsby-resp-image-background-image' style="padding-bottom: 59.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACN0lEQVQoz62QzWsTQRiH9+RJ8NSm2yS0thTbTVKNgX4YSzUVRS8WvHuLsOI/ICK2BENA6k3Qi/UTklx68aRgUs1Hk7Rus/hRkmw3aZLd7G5iVbSNmdl5JWsugpeIP3hmhpl5H3hfiqJ6DhwZsl4eGhm+NuGaYaem3azd4TQYHhllzZZB1mw9zJotA8bZYhkwMO7Ng2yvqZ/tNZmv9tHWKz0m+iBFW0f75mZnfnjmzsCF8/Nwcf4SnHTPwvSUG1yuSWCYcbDZjoLd4QSbwwmMsR8Hu+MYOMadcMpzDk57zsLE5AkYG7Mz1O3rPnptI6FwfAqSbyMoGnmJ11IJ/OJ1FL9JJzCXjOCVaAwn0nEcz2TwRiqOV6JJzHHrOLYawykug7n1iJ5cffVz+cE9hlq6s0QLyntN0UrwRdnRFUkk1XKBbG5x5FP+HdmuVkiyIJItUSTFQo7sa2UilT+QUnGT1GWBKDtpolU+Ql2tomDwOUPdWLxJC2JOq5RLUBYFXRAK0KhV4HNDAqlagkpNgXxFgu2qDJpag+9fVfi2q0FNkmC3oUBDk0ldVUBVa+jps8cMtXBrgc7nC5osyyCKRT2Xy8He3j50EdJedF1HoVCIoQKBAI0Q0jqPuvGDkG4whAih30K/3083m02tI9LJP6RdizH+Q6h0hIgQgrsEtTtDCDWDwaDRcn+r1epqaH8dJCEQDoftlNfrPcRx3F2e559ks9mH2Wx2uUvaNY94nr/v8/loqh0A+G/8AlOz4RVw2REqAAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class='gatsby-resp-image-image' alt='Displaying a map on the index page' title='Displaying a map on the index page' src='/static/ccce54f696fd02433ca3afdede745e40/d5bfb/display-map.png' srcset='/static/ccce54f696fd02433ca3afdede745e40/5a46d/display-map.png 300w,
/static/ccce54f696fd02433ca3afdede745e40/0a47e/display-map.png 600w,
/static/ccce54f696fd02433ca3afdede745e40/d5bfb/display-map.png 1072w' sizes='(max-width: 1072px) 100vw, 1072px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>
    </span>
    <figcaption class='gatsby-resp-image-figcaption'>Displaying a map on the index page</figcaption>
  </figure></p>
<p>A few things happening here. First, you will need to create a free <a href="https://mapbox">Mapbox</a> account to get an <code class="language-text">accessToken</code> to be able to use the map on your website. I think their free plan is very generous for doing all the local development as well as publishing small personal projects.</p>
<p>I am using React hooks - <code class="language-text">useRef()</code> to access the map container DOM element. <code class="language-text">useState()</code> to store the map object as a state so that I can use the value in other parts of the component, and <code class="language-text">useEffect()</code> to create the map object when the component mounts. The empty dependency array as second argument to the <code class="language-text">useEffect()</code> is important. I made many mistakes with this argument throughout the project. If you remove the second argument you will notice it will go into an endless loop. This is because <code class="language-text">useEffect()</code> runs whenever there is a change in states, and because we are using <code class="language-text">setMap(map)</code> inside the same hook, it keeps on running and running again. By having the empty array, the effect hook will only run once when the component mounts, which is what we need because we only want to create a new map once and use the same map afterwards. <code class="language-text">return () => map.remove()</code> is to clean up when the component unmounts.</p>
<h2>Add Place Markers</h2>
<p>Now, let's add some markers on the map. Each blog post will contain an array of places data and I want to create a marker for each. Eventually, this will be handled through the frontmatter of Markdown files, but for now, let's create a simple object with the coordinates as data source.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// on top of map.js</span>
<span class="token keyword">const</span> places <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Empire State Building"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">73.9856</span><span class="token punctuation">,</span>
    <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">40.7497</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Birch Coffee"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">73.9864</span><span class="token punctuation">,</span>
    <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">40.7438</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"B&amp;H"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">73.9961</span><span class="token punctuation">,</span>
    <span class="token literal-property property">latitude</span><span class="token operator">:</span> <span class="token number">40.753</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre></div>
<p>I am manually creating data for each place. I got the coordinates by right-clicking on Google map. What would be much better is that we supply the name or address of a place, and let the API figure out the coordinates. That is what I eventually ended up implementing, but I am not covering it here to keep this post concise. If you're interested in it, take a look at <a href="https://docs.mapbox.com/api/search/geocoding/">Mapbox Geocoding API</a>, which does exactly that. One mistake I made was to try using batch geocoding. After a few failed attempts, I realized it is only for paid customers. But you can still make multiple requests.</p>
<p>Now, back to our markers... I will create new components <code class="language-text">Marker</code> and <code class="language-text">Markers</code> in a file <code class="language-text">markers.js</code></p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// markers.js</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> mapboxgl <span class="token keyword">from</span> <span class="token string">"mapbox-gl"</span>

<span class="token keyword">const</span> <span class="token function-variable function">Marker</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> map<span class="token punctuation">,</span> place <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> markerRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> marker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mapboxgl<span class="token punctuation">.</span>Marker</span><span class="token punctuation">(</span>markerRef<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">setLngLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>place<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> place<span class="token punctuation">.</span>latitude<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> marker<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>markerRef<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">Markers</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> map<span class="token punctuation">,</span> places <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>places <span class="token operator">&amp;&amp;</span>
        places<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">place</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Marker</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>place<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">map</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>map<span class="token punctuation">}</span></span> <span class="token attr-name">place</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>place<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Markers</code></pre></div>
<p>I am taking a very similar approach to what I have done to the Map component. the <code class="language-text">Markers</code> component will get two props from the <code class="language-text">Map</code> component - a reference to the map and the places data, which will be passed onto the <code class="language-text">Marker</code> components, which will handle adding each marker to the map.</p>
<p>Now, we need to use the <code class="language-text">Markers</code> component in the <code class="language-text">Map</code> component. But before that, I will use the <a href="http://turfjs.org">Turf.js library</a> to calculate the bounding box of multiple marker coordinates so that the map can re-center itself anytime markers update. I am also installing the <code class="language-text">@turf/helpers</code> to convert the coordinates into geojson objects as that is what turfjs functions expect as inputs.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> @turf/bbox @turf/helpers</code></pre></div>
<p>In the <code class="language-text">map.js</code>, I will create a new <code class="language-text">useEffect()</code> hook. The first effect hook we used was to run <em>once</em> to create a new map, but the markers will be created and removed many times whenever we navigate between pages, so the new effect hook with different dependency array will be necessary.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// in map.js</span>

<span class="token comment">// add new modules</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> mapboxgl <span class="token keyword">from</span> <span class="token string">"mapbox-gl"</span>
<span class="token keyword">import</span> bbox <span class="token keyword">from</span> <span class="token string">"@turf/bbox"</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> multiPoint <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@turf/helpers"</span>
<span class="token keyword">import</span> Markers <span class="token keyword">from</span> <span class="token string">"./markers"</span>
<span class="token keyword">import</span> <span class="token string">"mapbox-gl/dist/mapbox-gl.css"</span>

<span class="token comment">// ... variables</span>

<span class="token keyword">const</span> <span class="token function-variable function">Map</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token comment">// ... ref, state, useEffect</span>

	<span class="token comment">// add new effect hook</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>map<span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>places<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      places<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">place</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        coords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>place<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> place<span class="token punctuation">.</span>latitude<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> feature <span class="token operator">=</span> <span class="token function">multiPoint</span><span class="token punctuation">(</span>coords<span class="token punctuation">)</span>
      <span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token function">bbox</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>

      map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>
        <span class="token punctuation">[</span>
          <span class="token punctuation">[</span>box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>box<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token literal-property property">maxZoom</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
          <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      map<span class="token punctuation">.</span><span class="token function">easeTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">73.9856</span><span class="token punctuation">,</span> <span class="token number">40.7497</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>map<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mapContainerRef<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mapContainerStyle<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>places <span class="token operator">&amp;&amp;</span> map <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Markers</span></span> <span class="token attr-name">map</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>map<span class="token punctuation">}</span></span> <span class="token attr-name">places</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>places<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Map</code></pre></div>
<p><figure class='gatsby-resp-image-figure' style=''>
    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1072px; '>
      <span class='gatsby-resp-image-background-image' style="padding-bottom: 59.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVQoz62Qy28SURSHZ+XKxI1SBugjbRoDMtixTVtpqqGYaNzU+Ae4w2SMa3Vh2gWEVhfd1EVXagwxwF+gpsa0KSDynImNFSqDMjxnKFBri7137jFQXGi6wfhLvpub+/hyzqEo6vSJs4O9twaHh+6Oj01zkxenOIZhOTNzgRsaNnI6fR9nMAxwtL6f0xkGOL1hgNP+3uv7OU2PjtP06O9o6d7bZzT0SUrfZ9TaL0//mLHb4fq1GzA7exOsU5dgcsIKY6MTYDKzYGZYOG9hgbGwcI5hYcTCgoUZAcYyCraZq2CzXYHxCSsYjWYTdf/BPB0Jr5eFRBTC8RCKxEI4ygt47o2AXa8jOBYN4HeBD/jVRhivBeN4Mx7HL9cDeGU1iJMbq/jzxxhOxqNqJPz+55PlZRO1tPCQLhfTslyWoFZT1Hw+R76WRHIvuUseb0qkUd0mpWKFrG1JRKnukKz4ibhi30gwVyY7+Syp5beIUilAvVZFPp/PRD1yueiMmJJzkgiSVFC/bKdBLGThbX4PIsU67DWqsNuoQbGqwP73OghFBUJSFepyCSoVBWRZJpVKGRRFRh6Px0TNzc3T6XRaLhQLkMmIaiqVgoP9A+gipLVgjI8qXFxcpBFCcudSbb8gBNQO5Bj+Om8LEUJHQrfbTTebTbkjUsk/5I8KO8JyR4gIIbhLUKszhFDT6/W2W9YdHh52NbRjB0kI+P1+M+VwOE4lEoklQRBe8Dz/lOf5Z13S+vNcEIQVp9NJU60AwH/jF9D84IxBccxGAAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class='gatsby-resp-image-image' alt='Newly added markers. Animation transition is a bonus.' title='Newly added markers. Animation transition is a bonus.' src='/static/25202c8cfd083523678896c65bcf65ea/d5bfb/map-with-markers.png' srcset='/static/25202c8cfd083523678896c65bcf65ea/5a46d/map-with-markers.png 300w,
/static/25202c8cfd083523678896c65bcf65ea/0a47e/map-with-markers.png 600w,
/static/25202c8cfd083523678896c65bcf65ea/d5bfb/map-with-markers.png 1072w' sizes='(max-width: 1072px) 100vw, 1072px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>
    </span>
    <figcaption class='gatsby-resp-image-figcaption'>Newly added markers. Animation transition is a bonus.</figcaption>
  </figure></p>
<p>We now have markers on the map for the Empire State Building, Birch Coffee (best latte in NYC) and B&#x26;H store. Play with <code class="language-text">places</code> array to add more markers. What is really nice about Mapbox is that it provides very useful methods like <code class="language-text">fitBounds()</code> and <code class="language-text">easeTo()</code>, and with the latter, we get a smooth transition animation for free. There are more animation options you can add. I encourage you to look at the Mapbox documentation.</p>
<h2>Add Markdown Files</h2>
<p>It's time to use the data from real blog posts instead of a simple <code class="language-text">places</code> object. I created a few Markdown <code class="language-text">.md</code> files in the <code class="language-text">content</code> folder with the frontmatter that includes the places data. Here is an example (<code class="language-text">content/1.md</code>):</p>
<div class="gatsby-highlight" data-language="mdx"><pre class="language-mdx"><code class="language-mdx">---
title: First Day in New York
date: 2020-12-27
places:
- {
	name: &quot;Empire State Building&quot;,
	longitude: -73.9856,
	latitude: 40.7497,
}
- {
	name: &quot;Birch Coffee&quot;,
	longitude: -73.9864,
	latitude: 40.7438,
}
---

I went to the Empire State Building and had a coffee at Birch Coffee.</code></pre></div>
<h2>Generate Pages through Gatsby Node API</h2>
<p>To generate pages from Markdown pages in Gatsby, there are a few extra steps to take. This is another topic so I won't explain much other than showing you the code necessary to run our project.</p>
<p>Install a Gatsby plugin.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> gatsby-transformer-remark</code></pre></div>
<p>Then, update <code class="language-text">gatsby-config.js</code> to include the plugin, <code class="language-text">gatsby-transformer-remark</code>.</p>
<p>Then, update <code class="language-text">gatsby-node.js</code>.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// gatsby-node.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> createFilePath <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">gatsby-source-filesystem</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">onCreateNode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node<span class="token punctuation">,</span> getNode<span class="token punctuation">,</span> actions <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> createNodeField <span class="token punctuation">}</span> <span class="token operator">=</span> actions
  <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'MarkdownRemark'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> slug <span class="token operator">=</span> <span class="token function">createFilePath</span><span class="token punctuation">(</span><span class="token punctuation">{</span> node<span class="token punctuation">,</span> getNode <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">createNodeField</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      node<span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">slug</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> slug
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> graphql<span class="token punctuation">,</span> actions <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> createPage <span class="token punctuation">}</span> <span class="token operator">=</span> actions
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">graphql</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    query {
      allMarkdownRemark {
        edges {
          node {
            fields {
              slug
            }
          }
        }
      }
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

  result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>edges<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> node<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>slug<span class="token punctuation">,</span>
      <span class="token literal-property property">component</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./src/templates/postTemplate.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">slug</span><span class="token operator">:</span> node<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>slug
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We need <code class="language-text">./src/templates/postTemplate.js</code>, which will be used as a template for our Markdown files.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// postTemplate.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Link<span class="token punctuation">,</span> graphql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'gatsby'</span>
<span class="token keyword">import</span> Layout <span class="token keyword">from</span> <span class="token string">"../components/layout"</span>

<span class="token keyword">const</span> <span class="token function-variable function">PostTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> frontmatter <span class="token operator">=</span> data<span class="token punctuation">.</span>markdownRemark<span class="token punctuation">.</span>frontmatter
  <span class="token keyword">const</span> html <span class="token operator">=</span> data<span class="token punctuation">.</span>markdownRemark<span class="token punctuation">.</span>html

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Layout</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>frontmatter<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">__html</span><span class="token operator">:</span> html <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Link</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token plain-text">Back to Index</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Link</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Layout</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PostTemplate

<span class="token keyword">export</span> <span class="token keyword">const</span> pageQuery <span class="token operator">=</span> graphql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query($slug: String!) {
    markdownRemark(fields: { slug: { eq: $slug }}) {
      html
      frontmatter {
        title
        places {
          name
          longitude
          latitude
        }
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span></code></pre></div>
<h2>Add Navigation</h2>
<p>At this point, you will need to restart the development server because we updated the <code class="language-text">gatsby-node.js</code>. If everything goes well, Gatsby will generate pages for you. Let's add a simple navigation in a new <code class="language-text">PostList</code> component in <code class="language-text">postList.js</code> We use <code class="language-text">useStaticQuery</code> to make GraphQL queries from a component, not from a page.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// postList.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Link<span class="token punctuation">,</span> graphql<span class="token punctuation">,</span> useStaticQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> graphql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query MyQuery {
    allMarkdownRemark {
      nodes {
        frontmatter {
          title
        }
        fields {
          slug
        }
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">const</span> <span class="token function-variable function">PostList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">useStaticQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
  <span class="token keyword">const</span> nodes <span class="token operator">=</span> data<span class="token punctuation">.</span>allMarkdownRemark<span class="token punctuation">.</span>nodes

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token literal-property property">listStyleType</span><span class="token operator">:</span> <span class="token string">"none"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>nodes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> title <span class="token operator">=</span> node<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>title
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Link</span></span> <span class="token attr-name">to</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>node<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>slug<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Link</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PostList</code></pre></div>
<p>And include it in <code class="language-text">layout.js</code></p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// layout.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span>
<span class="token keyword">import</span> Map <span class="token keyword">from</span> <span class="token string">"./map"</span>
<span class="token keyword">import</span> PostList <span class="token keyword">from</span> <span class="token string">'./postList'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Layout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">margin</span><span class="token operator">:</span> <span class="token string">'0 40px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">PostList</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

Layout<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>node<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Layout</code></pre></div>
<p><figure class='gatsby-resp-image-figure' style=''>
    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1072px; '>
      <span class='gatsby-resp-image-background-image' style="padding-bottom: 59.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACfklEQVQoz62OS0hUYRiGz6pV0KbUMzNeUCRmnJk8KBqSiU5QrXLRul3CifaREAQWIyi5UMSVRUioi9YVQije53pOc3ECR505zu0c56Jz9fznf8NLi4iiqAee7/tW7/cyDHP5wtXG2geNzU2PO9q6+a4bN3mOa+dbLBzf1Gzkdfo63mBo4Fl9Pa8zNPB6QwNf8/3W1/NV1Tq+qlr/qIatHbhSxV5k9HXGGltPd6HPZsPdO/fQ338fPT02XO/sQntbJ0xmDmYLh2tWDhYrhxYLh1YrB6ulFRZrG3r7bqO39xY6OrtgNJpNzJOnz1nHxlJS9Dix6V5XHa414vCK5Nknkbz46CAu5wr5vLJJPixvkMVVN/G73eTd0gqZWlgl3uUFEvK5iNft1Bwb65WJ8XETM/JykI3th2Q5KSGdVrRodI9KqT066CvQ0WCMHmXCNBFP0cUtiSoHabq7E6QvXBG6Gk3S9P4uzexvUSUVQzZzoM7NzZmY8bExNpGU5Eg0jFgsoUmRCALhIN4HYlgKxyEnJBzmsoinFRSPshDjCtakA2TlBFIpBbIs01QqCUWR1ZmZGRMzMTHJ5vN5ORj0w+/3a6HQV4TDOwgIXgREAV98PuRyOfwGejIIIWcNR0aG2WKxJGcyZRwdlbTj4wIqlTLKlQqKxRJKpSLy+Tw0TQMoBaUU2vk+9zRQVdWzwMlJO3t4WJadTg1uN9G2tynVtNOvP/krfmg4OmpnC4VyMpnUEI8TVZIIqVQ0AlBC6R+pAtBUVS3Pzs6aGLt9WKeqxyX8IydF5+fnzczAwMNLHo/nldcrvPV4hGmvV3gtCH/ltCAIb0RRnBoaGmKZEwD8N78B0Njce9A9EbwAAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class='gatsby-resp-image-image' alt='Pages and navigation' title='Pages and navigation' src='/static/83a70e94e7e480a631015603788c6bf6/d5bfb/page-navigation.png' srcset='/static/83a70e94e7e480a631015603788c6bf6/5a46d/page-navigation.png 300w,
/static/83a70e94e7e480a631015603788c6bf6/0a47e/page-navigation.png 600w,
/static/83a70e94e7e480a631015603788c6bf6/d5bfb/page-navigation.png 1072w' sizes='(max-width: 1072px) 100vw, 1072px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>
    </span>
    <figcaption class='gatsby-resp-image-figcaption'>Pages and navigation</figcaption>
  </figure></p>
<p>We can now navigate between pages, but There are a few issues. First, on each page load, the map reloads, which causes unnecessary API calls and also break the user experience. Another ovbious issue is that the markers on all pages are the same because we have not yet connected GraphQL query data back to our map component. We will need props to handle that.</p>
<h2>Gatsby Browser API</h2>
<p>At first, I thought that the <code class="language-text">Layout</code> component will not reload on every page because it is wrapping the children, but later discovered that's not the case as you can see from <a href="https://www.gatsbyjs.com/docs/how-to/routing/layout-components/#how-to-prevent-layout-components-from-unmounting">the Gatsby website's explanation</a>. We will need to remove the wrapping <code class="language-text">Layout</code> component from our pages and use the <code class="language-text">wrapPageElement</code> browser API in <code class="language-text">gatsby-browser.js</code>. I never used this API before so it was a learning experience. The implementation itself is very simple, and you can find more info on <a href="https://www.gatsbyjs.com/docs/reference/config-files/gatsby-browser/#wrapPageElement">the API reference</a>. You also want to use the exact same code in <code class="language-text">gatsby-ssr.js</code> for Server-Side Rendering.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// gatsby-browser.js &amp; gatsby-ssr.js</span>
<span class="token keyword">const</span> React <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Layout <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./src/components/layout'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default

exports<span class="token punctuation">.</span><span class="token function-variable function">wrapPageElement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> element<span class="token punctuation">,</span> props <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Layout <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>element<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Layout<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre></div>
<p>Don't forget to remove all the layout components you are using in each page and template, otherwise, you will see the map rendered twice. Now, when you navigate between pages, the map stays the same. What's nice is that you can still use any props that your page receives and pass them to the layout. We need this to pass the places data from our page to the map in the <code class="language-text">Layout</code> component.</p>
<h2>Update Map Component To Use Props</h2>
<p>To send differen places data from each page to our <code class="language-text">Map</code> component, we need to update the <code class="language-text">Map</code> component to take props.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// in map.js</span>

<span class="token comment">// ... remove const places</span>

<span class="token comment">// add props &amp; update places to props.places</span>
<span class="token keyword">const</span> <span class="token function-variable function">Map</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token comment">// ...</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>map<span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>places <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span>places<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      props<span class="token punctuation">.</span>places<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">place</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        coords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>place<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> place<span class="token punctuation">.</span>latitude<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> feature <span class="token operator">=</span> <span class="token function">multiPoint</span><span class="token punctuation">(</span>coords<span class="token punctuation">)</span>
      <span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token function">bbox</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>

      map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>
        <span class="token punctuation">[</span>
          <span class="token punctuation">[</span>box<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> box<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span>box<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> box<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          <span class="token literal-property property">maxZoom</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
          <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      map<span class="token punctuation">.</span><span class="token function">easeTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">73.9856</span><span class="token punctuation">,</span> <span class="token number">40.7497</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>map<span class="token punctuation">,</span> props<span class="token punctuation">.</span>places<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mapContainerRef<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mapContainerStyle<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>places <span class="token operator">&amp;&amp;</span> map <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Markers</span></span> <span class="token attr-name">map</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>map<span class="token punctuation">}</span></span> <span class="token attr-name">places</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>places<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<h2>Send Places Data to Layout Component</h2>
<p>Lastly, send the places data to the <code class="language-text">Layout</code> component, which will then be passed onto the <code class="language-text">Map</code> component. I am using <code class="language-text">useState()</code> hook because places data will be different for each page and I need to update the values accordingly. <code class="language-text">useEffect()</code> hook will make sure it is updated only when <code class="language-text">props</code> are updated.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// layout.js</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span>
<span class="token keyword">import</span> Map <span class="token keyword">from</span> <span class="token string">"./map"</span>
<span class="token keyword">import</span> PostList <span class="token keyword">from</span> <span class="token string">'./postList'</span>

<span class="token keyword">const</span> <span class="token function-variable function">Layout</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> children <span class="token operator">=</span> props<span class="token punctuation">.</span>children
  <span class="token keyword">const</span> <span class="token punctuation">[</span>places<span class="token punctuation">,</span> setPlaces<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>props <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setPlaces</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>data<span class="token punctuation">.</span>markdownRemark<span class="token punctuation">.</span>frontmatter<span class="token punctuation">.</span>places<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">setPlaces</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span></span> <span class="token attr-name">places</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>places<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">margin</span><span class="token operator">:</span> <span class="token string">'0 40px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">PostList</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

Layout<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>node<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Layout
</code></pre></div>
<p><figure class='gatsby-resp-image-figure' style=''>
    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1072px; '>
      <span class='gatsby-resp-image-background-image' style="padding-bottom: 59.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACfElEQVQoz63PS0wTQRgH8D15MvFgQtkur6BEKVAoBghgMBQ5GG/o2Zskazh4QYyJpx5KUuLJol7QGEmgEmPUBBIPGo1FabuvlGeg0LJQt9snbbctMzuf2eLFRI1G/8lv5vT95xuKok4eO1Nffa2+4dRIR3sv293bx7a2dbBNLTb2dEMja2ZqWXNV3dHN1LFMVS3LVNWVmZka1mRi2AoTc6OSrh6uMJmPU0yNpdLedz5vH7gIly8NwZWhqzDQPwDdXT3Qfq4LmprboNVqA6vVBi1WGzS3GNrKrK0dcME+CP32Qejs7IGzjU0Wauz2LdofCCi8wIPfO4dcbxfw6MIyHp0X8aP3POb8Pvzqwye86PNh7+ISXvR6sT/gw0ucH3/+OI99S++wwPM6z3Elt9ttoRx3x2h5M6iqigzcxhv9jhQhIxIiN4Ma+bInk3QsSkK7ESJsR8hGSCbK/i5RYgpJbQlEDgXI170IUeQdSCYTaO65x0K5XC46Hl5To2sB8G1z+uudNLzYiMPL9QiEY9sQ3Q9DLqlC9iADiUQU0qkYZJIqpKNhSMQTEFdVoigKxGIKmp5+ZqHuux/Q2bymrqwuw+rKqh5aX4Pd0CasiAJIogTBYBDSmQz8JsQ4dF1Hs7OzxobjtKYV1FSqCNlsQS8dalAslcq0ggYFTYNcLmcMACHkZ8qFCKGjwslJJ31wUFT9fh04DutbW4QYs99f/sGvYhRijI8KJyacdD5fVBRFh2gUI1nGuFTSMQDBhPwRZPwYIVScmZmxUE7nuBmhwwL8Y4xFPR5PMzU8fP0Ez/P3BEF8yvPilCCIj0Xxr0yJovhEkqSHDoeDpowAwH/zDQF62tWsfwBBAAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <img class='gatsby-resp-image-image' alt='Now, we can update data and markers properly.' title='Now, we can update data and markers properly.' src='/static/e33de6aab7dfb7c5d4db68411f7da286/d5bfb/correct-markers.png' srcset='/static/e33de6aab7dfb7c5d4db68411f7da286/5a46d/correct-markers.png 300w,
/static/e33de6aab7dfb7c5d4db68411f7da286/0a47e/correct-markers.png 600w,
/static/e33de6aab7dfb7c5d4db68411f7da286/d5bfb/correct-markers.png 1072w' sizes='(max-width: 1072px) 100vw, 1072px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>
    </span>
    <figcaption class='gatsby-resp-image-figcaption'>Now, we can update data and markers properly.</figcaption>
  </figure></p>
<p>That's it! And here is a repo with the complete code.</p>
<p><a href="https://github.com/erraticgenerator/gatsby-mapbox-blog">https://github.com/erraticgenerator/gatsby-mapbox-blog</a></p>
<p>This is a bare bone structure and I hope you can make it more usable and pleasant to look at.
There is basically no styling because I wanted to keep it simple and focus on the main task. Feel free to use it to make your own website.</p>
<h2>Next steps</h2>
<p>I learned a lot by working on this project, especially about how to use the React hooks - what to store in <code class="language-text">useRef()</code> or <code class="language-text">useState()</code>, and when to call <code class="language-text">useEffect()</code>. I am excited to do more experiments with the Mapbox and here are a few things I will look into.</p>
<ul>
<li>Add popup on each place marker</li>
<li>Add custom marker design (ie. SVG)</li>
<li>Add marker animation</li>
<li>Add custom map styles</li>
</ul>
<h2>References</h2>
<p>Here are some references that I found very useful.</p>
<ul>
<li><a href="https://github.com/mapbox/mapbox-react-examples">Mapbox React examples repo</a>: There are only a few examples but I got a lot of help from the repo as they covered almost everything I needed to know.</li>
<li><a href="https://docs.mapbox.com/mapbox-gl-js/example/">Mapbox examples</a>: Most of them are in vanilla JS but using the hooks we covered in this post, I think it would be fairly simple to translate them to React.</li>
</ul></div><style data-emotion="css gi1u7h">.css-gi1u7h{margin-top:60px;padding:30px;border-top:1px solid #aaa;font-size:1.8rem;text-align:center;}</style><div class="css-gi1u7h"><style data-emotion="css 1l67l6w">.css-1l67l6w{margin-bottom:16px;color:#666;}</style><p class="css-1l67l6w">If you liked my contents, please consider supporting. Thank you!</p><p>Tezos donation address: <pre>tz1cr64U6Ga4skQ4oWYqchFLGgT6mmkyQZe9</pre></p><p>Kofi donation link:</p><a href="https://ko-fi.com/E1E12Z9TZ" target="_blank" rel="noreferrer" class="css-0"><img style="border:0;height:36px" src="https://cdn.ko-fi.com/cdn/kofi2.png?v=2" alt="Buy Me a Coffee at ko-fi.com"/></a></div></div></main><style data-emotion="css d9qqnj">.css-d9qqnj{grid-row:3/4;}</style><style data-emotion="css 1f21wwo">.css-1f21wwo{margin-top:48px;height:100px;background-image:linear-gradient(white 0%, #fdd 100%);}</style><footer class="css-1f21wwo"><style data-emotion="css dsh6eg">.css-dsh6eg{margin:0 auto;padding:0 12px;max-width:800px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-dsh6eg"><style data-emotion="css 10r641u">.css-10r641u{font-size:1.2rem;}</style><div class="css-10r641u">Copyright 2020-2021 • ErraticGenerator.com •<!-- --> <a href="/privacy/">Our Privacy Policy</a></div><style data-emotion="css 11f9kv5">.css-11f9kv5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:3rem;list-style-type:none;}.css-11f9kv5 li{margin:0 10px;}</style><ul class="css-11f9kv5"><li><a href="mailto:erraticgenerator@gmail.com" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></a></li><li><a href="https://instagram.com/erraticgenerator" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 306.9c-113.5 0-205.1 91.6-205.1 205.1S398.5 717.1 512 717.1 717.1 625.5 717.1 512 625.5 306.9 512 306.9zm0 338.4c-73.4 0-133.3-59.9-133.3-133.3S438.6 378.7 512 378.7 645.3 438.6 645.3 512 585.4 645.3 512 645.3zm213.5-394.6c-26.5 0-47.9 21.4-47.9 47.9s21.4 47.9 47.9 47.9 47.9-21.3 47.9-47.9a47.84 47.84 0 0 0-47.9-47.9zM911.8 512c0-55.2.5-109.9-2.6-165-3.1-64-17.7-120.8-64.5-167.6-46.9-46.9-103.6-61.4-167.6-64.5-55.2-3.1-109.9-2.6-165-2.6-55.2 0-109.9-.5-165 2.6-64 3.1-120.8 17.7-167.6 64.5C132.6 226.3 118.1 283 115 347c-3.1 55.2-2.6 109.9-2.6 165s-.5 109.9 2.6 165c3.1 64 17.7 120.8 64.5 167.6 46.9 46.9 103.6 61.4 167.6 64.5 55.2 3.1 109.9 2.6 165 2.6 55.2 0 109.9.5 165-2.6 64-3.1 120.8-17.7 167.6-64.5 46.9-46.9 61.4-103.6 64.5-167.6 3.2-55.1 2.6-109.8 2.6-165zm-88 235.8c-7.3 18.2-16.1 31.8-30.2 45.8-14.1 14.1-27.6 22.9-45.8 30.2C695.2 844.7 570.3 840 512 840c-58.3 0-183.3 4.7-235.9-16.1-18.2-7.3-31.8-16.1-45.8-30.2-14.1-14.1-22.9-27.6-30.2-45.8C179.3 695.2 184 570.3 184 512c0-58.3-4.7-183.3 16.1-235.9 7.3-18.2 16.1-31.8 30.2-45.8s27.6-22.9 45.8-30.2C328.7 179.3 453.7 184 512 184s183.3-4.7 235.9 16.1c18.2 7.3 31.8 16.1 45.8 30.2 14.1 14.1 22.9 27.6 30.2 45.8C844.7 328.7 840 453.7 840 512c0 58.3 4.7 183.2-16.2 235.8z"></path></svg></a></li><li><a href="https://erraticgenerator.medium.com" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M834.7 279.8l61.3-58.9V208H683.7L532.4 586.4 360.3 208H137.7v12.9l71.6 86.6c7 6.4 10.6 15.8 9.7 25.2V673c2.2 12.3-1.7 24.8-10.3 33.7L128 805v12.7h228.6v-12.9l-80.6-98a39.99 39.99 0 0 1-11.1-33.7V378.7l200.7 439.2h23.3l172.6-439.2v349.9c0 9.2 0 11.1-6 17.2l-62.1 60.3V819h301.2v-12.9l-59.9-58.9c-5.2-4-7.9-10.7-6.8-17.2V297a18.1 18.1 0 0 1 6.8-17.2z"></path></svg></a></li><li><a href="https://twitter.com/erraticgener8or" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 254.3c-30.6 13.2-63.9 22.7-98.2 26.4a170.1 170.1 0 0 0 75-94 336.64 336.64 0 0 1-108.2 41.2A170.1 170.1 0 0 0 672 174c-94.5 0-170.5 76.6-170.5 170.6 0 13.2 1.6 26.4 4.2 39.1-141.5-7.4-267.7-75-351.6-178.5a169.32 169.32 0 0 0-23.2 86.1c0 59.2 30.1 111.4 76 142.1a172 172 0 0 1-77.1-21.7v2.1c0 82.9 58.6 151.6 136.7 167.4a180.6 180.6 0 0 1-44.9 5.8c-11.1 0-21.6-1.1-32.2-2.6C211 652 273.9 701.1 348.8 702.7c-58.6 45.9-132 72.9-211.7 72.9-14.3 0-27.5-.5-41.2-2.1C171.5 822 261.2 850 357.8 850 671.4 850 843 590.2 843 364.7c0-7.4 0-14.8-.5-22.2 33.2-24.3 62.3-54.4 85.5-88.2z"></path></svg></a></li></ul></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-185826355-1"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-185826355-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-185826355-1', {"anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/gatsby-blog-with-mapbox-gl-js-using-react-hooks/";window.___webpackCompilationHash="ce17d47b0013f050d652";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-15952ba86378d587006d.js"],"app":["/app-45d7508fd8245f182e57.js"],"component---src-pages-404-js":["/component---src-pages-404-js-b97ca9d0c56aa78522b5.js"],"component---src-pages-about-js":["/component---src-pages-about-js-a6d11f0b1ef4089dbcef.js"],"component---src-pages-index-js":["/component---src-pages-index-js-e97f9eb9a7c5d1c8bac6.js"],"component---src-pages-privacy-js":["/component---src-pages-privacy-js-1b495cf46d86421cec09.js"],"component---src-templates-blog-post-template-js":["/component---src-templates-blog-post-template-js-478bf50e9978849b5b40.js"]};/*]]>*/</script><script src="/polyfill-15952ba86378d587006d.js" nomodule=""></script><script src="/component---src-templates-blog-post-template-js-478bf50e9978849b5b40.js" async=""></script><script src="/eb9d8cad3e7a5281726e7c4ed76f1fbad1e5b719-6acf9f4f59ccff7436a6.js" async=""></script><script src="/commons-a19e32fc4bdcf911055e.js" async=""></script><script src="/app-45d7508fd8245f182e57.js" async=""></script><script src="/framework-68cf14eef5bda77f0f65.js" async=""></script><script src="/webpack-runtime-ceba9cd646c3ad263f69.js" async=""></script></body></html>