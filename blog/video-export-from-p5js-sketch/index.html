<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.8b5b382a01b64608909a.css">code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}body .gist .highlight{background:#fdf6e3}body .gist .blob-code-inner,body .gist .blob-num,body .gist .pl-s1 .pl-s2,body .gist .pl-smi,body .gist .pl-smp,body .gist .pl-stj,body .gist .pl-vo,body .gist .pl-vpf{color:#657b83}body .gist .pl-c,body .gist .pl-c span{color:#93a1a1;font-style:italic}body .gist .pl-mb{color:#2aa198;font-weight:700}body .gist .pl-mh .pl-en{color:#cb4b16;font-weight:700}body .gist .pl-mi{color:#859900;font-style:italic}body .gist .pl-c1,body .gist .pl-pds,body .gist .pl-s1,body .gist .pl-s1 .pl-pse .pl-s2,body .gist .pl-sv{color:#2aa198}body .gist .pl-e,body .gist .pl-en,body .gist .pl-ent,body .gist .pl-s,body .gist .pl-v{color:#268bd2}body .gist .pl-k,body .gist .pl-mdh,body .gist .pl-mdr,body .gist .pl-ml,body .gist .pl-mm,body .gist .pl-mo,body .gist .pl-mp,body .gist .pl-mr,body .gist .pl-ms,body .gist .pl-s1 .pl-v,body .gist .pl-s3{color:#859900}body .gist .pl-mh,body .gist .pl-sc,body .gist .pl-sr .pl-cce{color:#cb4b16}body .gist .highlight-source-css .pl-k,body .gist .pl-mq{color:#93a1a1}body .gist .pl-sr,body .gist .pl-sr .pl-sra,body .gist .pl-sr .pl-sre,body .gist .pl-src{color:#d30102}body .gist .highlight-source-c\+\+ .pl-s,body .gist .pl-st{color:#dc322f}body .gist .pl-mdht,body .gist .pl-mi1{color:#657b83;background:rgba(0,64,0,.5)}body .gist .pl-id,body .gist .pl-ii,body .gist .pl-md,body .gist .pl-mdhf{color:#657b83;background:rgba(64,0,0,.5)}</style><meta name="generator" content="Gatsby 2.26.1"/><title data-react-helmet="true">Video Export from p5.js Sketch | ErraticGenerator.com</title><meta data-react-helmet="true" name="description" content="The p5.js library itself does not have a way to export a video out of a sketch but because everything you do is simply drawing on an HTML…"/><meta data-react-helmet="true" name="image"/><meta data-react-helmet="true" property="og:url" content="https://erraticgenerator.com/blog/video-export-from-p5js-sketch"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Video Export from p5.js Sketch"/><meta data-react-helmet="true" property="og:description" content="The p5.js library itself does not have a way to export a video out of a sketch but because everything you do is simply drawing on an HTML…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Video Export from p5.js Sketch"/><meta data-react-helmet="true" name="twitter:description" content="The p5.js library itself does not have a way to export a video out of a sketch but because everything you do is simply drawing on an HTML…"/><link href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css" rel="stylesheet"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-3d855f313f7e8d8d5126.js"/><link as="script" rel="preload" href="/framework-de237a875aa45b276a9d.js"/><link as="script" rel="preload" href="/app-17076851edb603384cdc.js"/><link as="script" rel="preload" href="/styles-7d4153d260c0197f0043.js"/><link as="script" rel="preload" href="/commons-b8d2d0e6cd0acc8389b5.js"/><link as="script" rel="preload" href="/77e824346eb342330b3ba237752743d1d190a1c1-44e23925d079bc9c8bd0.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-template-js-0b42d03e1b5cb581436d.js"/><link as="fetch" rel="preload" href="/page-data/blog/video-export-from-p5js-sketch/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1696241065.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3380088787.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 1j3ddox">.css-1j3ddox{height:100%;display:grid;grid-template-columns:100%;grid-template-rows:120px auto 100px;}.css-1j3ddox p{margin-bottom:2.4rem;font-size:1.8rem;line-height:1.6;}</style><div class="css-1j3ddox"><style data-emotion="css-global 7l1jaa">@import url("https://fonts.googleapis.com/css2?family=Andika+New+Basic:ital@0;1&family=Open+Sans:wght@400;700&display=swap");*{margin:0;box-sizing:border-box;}html,body{font-family:"Andika New Basic",sans-serif;font-size:10px;height:100%;}a{color:black;-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css yepcm5">.css-yepcm5{grid-row:1/2;}</style><style data-emotion="css 8souqa">.css-8souqa{margin-bottom:48px;padding:12px 0;height:120px;background-image:linear-gradient(#fdd 0%, white 100%);}</style><header class="css-8souqa"><style data-emotion="css 1uarw26">.css-1uarw26{margin:0 auto;padding:0 12px;max-width:720px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-1uarw26"><style data-emotion="css 16xc8z8">.css-16xc8z8{-webkit-flex:4;-ms-flex:4;flex:4;}@media (max-width: 600px){.css-16xc8z8{-webkit-flex:6;-ms-flex:6;flex:6;}}</style><div class="css-16xc8z8"><style data-emotion="css 1t1kjl2">.css-1t1kjl2{font-family:"Open Sans",sans-serif;font-weight:700;}</style><h1 class="css-1t1kjl2"><a href="/">Erratic Generator</a></h1><style data-emotion="css mmvz9h">.css-mmvz9h{font-weight:400;}</style><h2 class="css-mmvz9h">Creative Coding and Design</h2></div><style data-emotion="css 18zyra0">.css-18zyra0{-webkit-flex:1;-ms-flex:1;flex:1;font-family:"Open Sans",sans-serif;font-size:1.6rem;}</style><a class="css-18zyra0" href="/about/">About</a></div></header><style data-emotion="css 1sg5m6l">.css-1sg5m6l{max-width:720px;width:100%;margin:0 auto;padding:0 12px;grid-row:2/3;}</style><main class="css-1sg5m6l"><div class="css-0"><style data-emotion="css 1tca0if">.css-1tca0if{margin-bottom:3rem;font-family:"Open Sans",sans-serif;}</style><header class="css-1tca0if"><style data-emotion="css 10d63d4">.css-10d63d4{margin-top:1rem;font-size:4rem;line-height:1.2;}</style><h1 class="css-10d63d4">Video Export from p5.js Sketch</h1><style data-emotion="css 5ezmz0">.css-5ezmz0{margin-bottom:0.6rem;color:#666;font-size:2.4rem;font-weight:400;}</style><h2 class="css-5ezmz0">Save mp4 videos from within a browser. No server needed.</h2><style data-emotion="css 1dqoxsa">.css-1dqoxsa{color:#666;font-size:1.8rem;}</style><time class="css-1dqoxsa">December 05, 2020</time></header><style data-emotion="css 11cvyr3">.css-11cvyr3 h2{margin-bottom:0.8rem;font-family:"Open Sans",sans-serif;font-size:2.4rem;}.css-11cvyr3 p{margin-bottom:2.4rem;font-size:1.8rem;line-height:1.6;}.css-11cvyr3 a{color:teal;-webkit-text-decoration:underline;text-decoration:underline;}.css-11cvyr3 ul{margin-bottom:2.4rem;font-size:1.8rem;}.css-11cvyr3 figure{margin:5rem auto;width:100%;}.css-11cvyr3 .gatsby-resp-image-wrapper{max-width:100%!important;}.css-11cvyr3 figure img{width:100%;}.css-11cvyr3 figure figcaption{padding:0.6rem 4%;color:#666;font-size:1.6rem;text-align:center;}.css-11cvyr3 .gist,.css-11cvyr3 .gatsby-highlight{margin:5rem auto;}.css-11cvyr3 .gist .gist-file{border:none;}.css-11cvyr3 .gatsby-highlight,.css-11cvyr3 .gist span{font-size:1.4rem;}</style><div class="css-11cvyr3"><p>The p5.js library itself does not have a way to export a video out of a sketch but because everything you do is simply drawing on an HTML5 Canvas, if you can find a library to export what’s on the Canvas, you should be able to use it. I recently stumbled upon a really good and simple library that exports to H.264 mp4 video straight out of a browser (no server needed) and made a simple example to make it work with a p5js sketch.</p>
<p>If you would rather check out the original library, here is the link, and I will also link to a few other resources at the end of this post.</p>
<p><a href="https://github.com/TrevorSundberg/h264-mp4-encoder">https://github.com/TrevorSundberg/h264-mp4-encoder</a></p>
<p>I only spent a little time with the library, but by far, this has been the easiest and most reliable way to export a video out of a p5js sketch. I have tried a few other libraries that will export to either image sequences or .webm videos, but this library directly exports to .mp4 format, which I think is still better supported than .webm, and also supports the current version of p5js (v1.x)</p>
<p>The example included in the original repo explains everything for general use, but I made two quick examples if you just want to take it and use it in your p5js sketch.</p>
<h2>Fixed-length Animation Loop</h2>
<p>The first one is when you have a fixed-length animation. You can first define <code class="language-text">numFrames</code> and play and record the animation. The only difference between a regular p5js sketch and this one is that I created the <code class="language-text">anim()</code> function to replace <code class="language-text">draw()</code> so I can loop it when I want to. You can just treat it like the draw function and do everything you need to inside. The UI is very minimal. If you only want to preview the animation, check the box, <em>preview only</em>. Here is the code:</p>
<p><div id="gist106790163" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-p5js-mp4-export-1-html" class="file my-2">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-html  ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-p5js-mp4-export-1-html-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-c1>&lt;!DOCTYPE html<span class=pl-kos>&gt;</span></span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-p5js-mp4-export-1-html-LC2" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;</span><span class=pl-ent>html</span> <span class=pl-c1>lang</span>=&quot;<span class=pl-s>en</span>&quot;<span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-p5js-mp4-export-1-html-LC3" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-p5js-mp4-export-1-html-LC4" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>charset</span>=&quot;<span class=pl-s>UTF-8</span>&quot;<span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-p5js-mp4-export-1-html-LC5" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>name</span>=&quot;<span class=pl-s>viewport</span>&quot; <span class=pl-c1>content</span>=&quot;<span class=pl-s>width=device-width, initial-scale=1.0</span>&quot;<span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-p5js-mp4-export-1-html-LC6" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span>Document<span class=pl-kos>&lt;/</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-p5js-mp4-export-1-html-LC7" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://unpkg.com/h264-mp4-encoder/embuild/dist/h264-mp4-encoder.web.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-p5js-mp4-export-1-html-LC8" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-p5js-mp4-export-1-html-LC9" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>style</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-p5js-mp4-export-1-html-LC10" class="blob-code blob-code-inner js-file-line">        <span class=pl-ent>html</span> { <span class=pl-c1>font-family</span>: sans-serif; <span class=pl-c1>font-size</span>: <span class=pl-c1>12<span class=pl-smi>px</span></span>; }</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-p5js-mp4-export-1-html-LC11" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;/</span><span class=pl-ent>style</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-p5js-mp4-export-1-html-LC12" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;/</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-p5js-mp4-export-1-html-LC13" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-p5js-mp4-export-1-html-LC14" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-p5js-mp4-export-1-html-LC15" class="blob-code blob-code-inner js-file-line">        <span class=pl-c>/*</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-p5js-mp4-export-1-html-LC16" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            library used: https://github.com/TrevorSundberg/h264-mp4-encoder </span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-p5js-mp4-export-1-html-LC17" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            </span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-p5js-mp4-export-1-html-LC18" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            a simple example exporting mp4 with p5js.</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-p5js-mp4-export-1-html-LC19" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            custom animation loop, not using draw(), fixed-length animation.</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-p5js-mp4-export-1-html-LC20" class="blob-code blob-code-inner js-file-line"><span class=pl-c>        */</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-p5js-mp4-export-1-html-LC21" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>cwidth</span> <span class=pl-c1>=</span> <span class=pl-c1>640</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-p5js-mp4-export-1-html-LC22" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>cheight</span> <span class=pl-c1>=</span> <span class=pl-c1>360</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-p5js-mp4-export-1-html-LC23" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>button</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-p5js-mp4-export-1-html-LC24" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>checkbox</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-p5js-mp4-export-1-html-LC25" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-p5js-mp4-export-1-html-LC26" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>const</span> <span class=pl-s1>frate</span> <span class=pl-c1>=</span> <span class=pl-c1>30</span> <span class=pl-c>// frame rate</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-p5js-mp4-export-1-html-LC27" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>const</span> <span class=pl-s1>numFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>100</span> <span class=pl-c>// num of frames to record</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-p5js-mp4-export-1-html-LC28" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>true</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-p5js-mp4-export-1-html-LC29" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-p5js-mp4-export-1-html-LC30" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>function</span> <span class=pl-en>setup</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-p5js-mp4-export-1-html-LC31" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>createCanvas</span><span class=pl-kos>(</span><span class=pl-s1>cwidth</span><span class=pl-kos>,</span> <span class=pl-s1>cheight</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-p5js-mp4-export-1-html-LC32" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>frameRate</span><span class=pl-kos>(</span><span class=pl-s1>frate</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-p5js-mp4-export-1-html-LC33" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>button</span> <span class=pl-c1>=</span> <span class=pl-en>createButton</span><span class=pl-kos>(</span><span class=pl-s>&#39;record&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-p5js-mp4-export-1-html-LC34" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>button</span><span class=pl-kos>.</span><span class=pl-en>mousePressed</span><span class=pl-kos>(</span><span class=pl-s1>record</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-p5js-mp4-export-1-html-LC35" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>checkbox</span> <span class=pl-c1>=</span> <span class=pl-en>createCheckbox</span><span class=pl-kos>(</span><span class=pl-s>&#39; preview only&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-p5js-mp4-export-1-html-LC36" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>checkbox</span><span class=pl-kos>.</span><span class=pl-en>style</span><span class=pl-kos>(</span><span class=pl-s>&#39;display&#39;</span><span class=pl-kos>,</span> <span class=pl-s>&#39;inline&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-p5js-mp4-export-1-html-LC37" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>checkbox</span><span class=pl-kos>.</span><span class=pl-en>changed</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-p5js-mp4-export-1-html-LC38" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>recording</span> <span class=pl-c1>=</span> !<span class=pl-s1>recording</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-p5js-mp4-export-1-html-LC39" class="blob-code blob-code-inner js-file-line">            <span class=pl-kos>}</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-p5js-mp4-export-1-html-LC40" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>anim</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>)</span> <span class=pl-c>// display first frame</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-p5js-mp4-export-1-html-LC41" class="blob-code blob-code-inner js-file-line">        <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-p5js-mp4-export-1-html-LC42" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-p5js-mp4-export-1-html-LC43" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>function</span> <span class=pl-en>anim</span><span class=pl-kos>(</span><span class=pl-s1>count</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-p5js-mp4-export-1-html-LC44" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>background</span><span class=pl-kos>(</span><span class=pl-c1>220</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-p5js-mp4-export-1-html-LC45" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>textSize</span><span class=pl-kos>(</span><span class=pl-c1>128</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-p5js-mp4-export-1-html-LC46" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>textAlign</span><span class=pl-kos>(</span><span class=pl-c1>CENTER</span><span class=pl-kos>,</span> <span class=pl-c1>CENTER</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-p5js-mp4-export-1-html-LC47" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>text</span><span class=pl-kos>(</span><span class=pl-s1>count</span><span class=pl-kos>,</span> <span class=pl-s1>width</span> / <span class=pl-c1>2</span><span class=pl-kos>,</span> <span class=pl-s1>height</span> / <span class=pl-c1>2</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-p5js-mp4-export-1-html-LC48" class="blob-code blob-code-inner js-file-line">        <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-p5js-mp4-export-1-html-LC49" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-p5js-mp4-export-1-html-LC50" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>function</span> <span class=pl-en>record</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-p5js-mp4-export-1-html-LC51" class="blob-code blob-code-inner js-file-line">            <span class=pl-c1>HME</span><span class=pl-kos>.</span><span class=pl-en>createH264MP4Encoder</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-k>async</span> <span class=pl-s1>encoder</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-p5js-mp4-export-1-html-LC52" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span> <span class=pl-c1>=</span> <span class=pl-s>&#39;test&#39;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-p5js-mp4-export-1-html-LC53" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>width</span> <span class=pl-c1>=</span> <span class=pl-s1>cwidth</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-p5js-mp4-export-1-html-LC54" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>height</span> <span class=pl-c1>=</span> <span class=pl-s1>cheight</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-p5js-mp4-export-1-html-LC55" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>frameRate</span> <span class=pl-c1>=</span> <span class=pl-s1>frate</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-p5js-mp4-export-1-html-LC56" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>kbps</span> <span class=pl-c1>=</span> <span class=pl-c1>50000</span> <span class=pl-c>// video quality</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-p5js-mp4-export-1-html-LC57" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>groupOfPictures</span> <span class=pl-c1>=</span> <span class=pl-c1>10</span> <span class=pl-c>// lower if you have fast actions.</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-p5js-mp4-export-1-html-LC58" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>initialize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-p5js-mp4-export-1-html-LC59" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-p5js-mp4-export-1-html-LC60" class="blob-code blob-code-inner js-file-line">                <span class=pl-k>for</span> <span class=pl-kos>(</span><span class=pl-k>let</span> <span class=pl-s1>i</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span><span class=pl-kos>;</span> <span class=pl-s1>i</span> <span class=pl-c1>&lt;</span> <span class=pl-s1>numFrames</span><span class=pl-kos>;</span> <span class=pl-s1>i</span><span class=pl-c1>++</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-p5js-mp4-export-1-html-LC61" class="blob-code blob-code-inner js-file-line">                    <span class=pl-en>anim</span><span class=pl-kos>(</span><span class=pl-s1>i</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-p5js-mp4-export-1-html-LC62" class="blob-code blob-code-inner js-file-line">                    <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>addFrameRgba</span><span class=pl-kos>(</span><span class=pl-s1>drawingContext</span><span class=pl-kos>.</span><span class=pl-en>getImageData</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-s1>canvas</span><span class=pl-kos>.</span><span class=pl-c1>width</span><span class=pl-kos>,</span> <span class=pl-s1>canvas</span><span class=pl-kos>.</span><span class=pl-c1>height</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-c1>data</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-p5js-mp4-export-1-html-LC63" class="blob-code blob-code-inner js-file-line">                    <span class=pl-k>await</span> <span class=pl-k>new</span> <span class=pl-v>Promise</span><span class=pl-kos>(</span><span class=pl-s1>resolve</span> <span class=pl-c1>=&gt;</span> <span class=pl-smi>window</span><span class=pl-kos>.</span><span class=pl-en>requestAnimationFrame</span><span class=pl-kos>(</span><span class=pl-s1>resolve</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-p5js-mp4-export-1-html-LC64" class="blob-code blob-code-inner js-file-line">                <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-p5js-mp4-export-1-html-LC65" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-p5js-mp4-export-1-html-LC66" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>finalize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-p5js-mp4-export-1-html-LC67" class="blob-code blob-code-inner js-file-line">                <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>recording</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-p5js-mp4-export-1-html-LC68" class="blob-code blob-code-inner js-file-line">                    <span class=pl-k>const</span> <span class=pl-s1>uint8Array</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>FS</span><span class=pl-kos>.</span><span class=pl-en>readFile</span><span class=pl-kos>(</span><span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-p5js-mp4-export-1-html-LC69" class="blob-code blob-code-inner js-file-line">                    <span class=pl-k>const</span> <span class=pl-s1>anchor</span> <span class=pl-c1>=</span> <span class=pl-smi>document</span><span class=pl-kos>.</span><span class=pl-en>createElement</span><span class=pl-kos>(</span><span class=pl-s>&#39;a&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-p5js-mp4-export-1-html-LC70" class="blob-code blob-code-inner js-file-line">                    <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>href</span> <span class=pl-c1>=</span> <span class=pl-c1>URL</span><span class=pl-kos>.</span><span class=pl-en>createObjectURL</span><span class=pl-kos>(</span><span class=pl-k>new</span> <span class=pl-v>Blob</span><span class=pl-kos>(</span><span class=pl-kos>[</span><span class=pl-s1>uint8Array</span><span class=pl-kos>]</span><span class=pl-kos>,</span> <span class=pl-kos>{</span> <span class=pl-c1>type</span>: <span class=pl-s>&#39;video/mp4&#39;</span> <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-p5js-mp4-export-1-html-LC71" class="blob-code blob-code-inner js-file-line">                    <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>download</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-p5js-mp4-export-1-html-LC72" class="blob-code blob-code-inner js-file-line">                    <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-en>click</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-p5js-mp4-export-1-html-LC73" class="blob-code blob-code-inner js-file-line">                <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-p5js-mp4-export-1-html-LC74" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>delete</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-p5js-mp4-export-1-html-LC75" class="blob-code blob-code-inner js-file-line">            <span class=pl-kos>}</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-p5js-mp4-export-1-html-LC76" class="blob-code blob-code-inner js-file-line">        <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-p5js-mp4-export-1-html-LC77" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-p5js-mp4-export-1-html-LC78" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;/</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-1-html-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-p5js-mp4-export-1-html-LC79" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;/</span><span class=pl-ent>html</span><span class=pl-kos>&gt;</span></td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/erraticgenerator/aef25bc40b0bda91690c7f3d150c61e7/raw/13e7f990279e3632ca127d11f203a35bec16f53e/p5js-mp4-export-1.html" style="float:right">view raw</a>
        <a href="https://gist.github.com/erraticgenerator/aef25bc40b0bda91690c7f3d150c61e7#file-p5js-mp4-export-1-html">p5js-mp4-export-1.html</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div></p>
<h2>Within the Regular Draw Loop</h2>
<p>The second example is when you want to record a video while the animation is being played. It won’t loop but will just capture the frames as it plays.</p>
<p><div id="gist106790422" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-p5js-mp4-export-2-html" class="file my-2">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-html  ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-p5js-mp4-export-2-html-LC1" class="blob-code blob-code-inner js-file-line"><span class=pl-c1>&lt;!DOCTYPE html<span class=pl-kos>&gt;</span></span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-p5js-mp4-export-2-html-LC2" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;</span><span class=pl-ent>html</span> <span class=pl-c1>lang</span>=&quot;<span class=pl-s>en</span>&quot;<span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-p5js-mp4-export-2-html-LC3" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-p5js-mp4-export-2-html-LC4" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-p5js-mp4-export-2-html-LC5" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>charset</span>=&quot;<span class=pl-s>UTF-8</span>&quot;<span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-p5js-mp4-export-2-html-LC6" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>meta</span> <span class=pl-c1>name</span>=&quot;<span class=pl-s>viewport</span>&quot; <span class=pl-c1>content</span>=&quot;<span class=pl-s>width=device-width, initial-scale=1.0</span>&quot;<span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-p5js-mp4-export-2-html-LC7" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span>Document<span class=pl-kos>&lt;/</span><span class=pl-ent>title</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-p5js-mp4-export-2-html-LC8" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://unpkg.com/h264-mp4-encoder/embuild/dist/h264-mp4-encoder.web.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-p5js-mp4-export-2-html-LC9" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span> <span class=pl-c1>src</span>=&quot;<span class=pl-s>https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js</span>&quot;<span class=pl-kos>&gt;</span><span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-p5js-mp4-export-2-html-LC10" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;/</span><span class=pl-ent>head</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-p5js-mp4-export-2-html-LC11" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-p5js-mp4-export-2-html-LC12" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-p5js-mp4-export-2-html-LC13" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-p5js-mp4-export-2-html-LC14" class="blob-code blob-code-inner js-file-line">        <span class=pl-c>/*</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-p5js-mp4-export-2-html-LC15" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            library used: https://github.com/TrevorSundberg/h264-mp4-encoder </span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-p5js-mp4-export-2-html-LC16" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            </span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-p5js-mp4-export-2-html-LC17" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            a simple example exporting mp4 with p5js.</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-p5js-mp4-export-2-html-LC18" class="blob-code blob-code-inner js-file-line"><span class=pl-c>            record video while animation is being played.</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-p5js-mp4-export-2-html-LC19" class="blob-code blob-code-inner js-file-line"><span class=pl-c>        */</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-p5js-mp4-export-2-html-LC20" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>cwidth</span> <span class=pl-c1>=</span> <span class=pl-c1>640</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-p5js-mp4-export-2-html-LC21" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>cheight</span> <span class=pl-c1>=</span> <span class=pl-c1>360</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-p5js-mp4-export-2-html-LC22" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>button</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-p5js-mp4-export-2-html-LC23" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-p5js-mp4-export-2-html-LC24" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>encoder</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-p5js-mp4-export-2-html-LC25" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-p5js-mp4-export-2-html-LC26" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>const</span> <span class=pl-s1>frate</span> <span class=pl-c1>=</span> <span class=pl-c1>30</span> <span class=pl-c>// frame rate</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-p5js-mp4-export-2-html-LC27" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>const</span> <span class=pl-s1>numFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>100</span> <span class=pl-c>// num of frames to record</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-p5js-mp4-export-2-html-LC28" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>false</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-p5js-mp4-export-2-html-LC29" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>recordedFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-p5js-mp4-export-2-html-LC30" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-p5js-mp4-export-2-html-LC31" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>let</span> <span class=pl-s1>count</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-p5js-mp4-export-2-html-LC32" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-p5js-mp4-export-2-html-LC33" class="blob-code blob-code-inner js-file-line">        <span class=pl-c>// make sure encoder is ready before use</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-p5js-mp4-export-2-html-LC34" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>function</span> <span class=pl-en>preload</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-p5js-mp4-export-2-html-LC35" class="blob-code blob-code-inner js-file-line">            <span class=pl-c1>HME</span><span class=pl-kos>.</span><span class=pl-en>createH264MP4Encoder</span><span class=pl-kos>(</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-en>then</span><span class=pl-kos>(</span><span class=pl-s1>enc</span> <span class=pl-c1>=&gt;</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-p5js-mp4-export-2-html-LC36" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span> <span class=pl-c1>=</span> <span class=pl-s1>enc</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-p5js-mp4-export-2-html-LC37" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span> <span class=pl-c1>=</span> <span class=pl-s>&#39;test&#39;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-p5js-mp4-export-2-html-LC38" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>width</span> <span class=pl-c1>=</span> <span class=pl-s1>cwidth</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-p5js-mp4-export-2-html-LC39" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>height</span> <span class=pl-c1>=</span> <span class=pl-s1>cheight</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-p5js-mp4-export-2-html-LC40" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>frameRate</span> <span class=pl-c1>=</span> <span class=pl-s1>frate</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-p5js-mp4-export-2-html-LC41" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>kbps</span> <span class=pl-c1>=</span> <span class=pl-c1>50000</span> <span class=pl-c>// video quality</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-p5js-mp4-export-2-html-LC42" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>groupOfPictures</span> <span class=pl-c1>=</span> <span class=pl-c1>10</span> <span class=pl-c>// lower if you have fast actions.</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-p5js-mp4-export-2-html-LC43" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>initialize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-p5js-mp4-export-2-html-LC44" class="blob-code blob-code-inner js-file-line">            <span class=pl-kos>}</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-p5js-mp4-export-2-html-LC45" class="blob-code blob-code-inner js-file-line">        <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-p5js-mp4-export-2-html-LC46" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-p5js-mp4-export-2-html-LC47" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>function</span> <span class=pl-en>setup</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-p5js-mp4-export-2-html-LC48" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>createCanvas</span><span class=pl-kos>(</span><span class=pl-s1>cwidth</span><span class=pl-kos>,</span> <span class=pl-s1>cheight</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-p5js-mp4-export-2-html-LC49" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>frameRate</span><span class=pl-kos>(</span><span class=pl-s1>frate</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-p5js-mp4-export-2-html-LC50" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>button</span> <span class=pl-c1>=</span> <span class=pl-en>createButton</span><span class=pl-kos>(</span><span class=pl-s>&#39;record&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-p5js-mp4-export-2-html-LC51" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>button</span><span class=pl-kos>.</span><span class=pl-en>mousePressed</span><span class=pl-kos>(</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-c1>=&gt;</span> <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>true</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-p5js-mp4-export-2-html-LC52" class="blob-code blob-code-inner js-file-line">        <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-p5js-mp4-export-2-html-LC53" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-p5js-mp4-export-2-html-LC54" class="blob-code blob-code-inner js-file-line">        <span class=pl-k>function</span> <span class=pl-en>draw</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-p5js-mp4-export-2-html-LC55" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>background</span><span class=pl-kos>(</span><span class=pl-c1>220</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-p5js-mp4-export-2-html-LC56" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>textSize</span><span class=pl-kos>(</span><span class=pl-c1>128</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-p5js-mp4-export-2-html-LC57" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>textAlign</span><span class=pl-kos>(</span><span class=pl-c1>CENTER</span><span class=pl-kos>,</span> <span class=pl-c1>CENTER</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-p5js-mp4-export-2-html-LC58" class="blob-code blob-code-inner js-file-line">            <span class=pl-en>text</span><span class=pl-kos>(</span><span class=pl-s1>count</span><span class=pl-kos>,</span> <span class=pl-s1>width</span> / <span class=pl-c1>2</span><span class=pl-kos>,</span> <span class=pl-s1>height</span> / <span class=pl-c1>2</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-p5js-mp4-export-2-html-LC59" class="blob-code blob-code-inner js-file-line">            <span class=pl-s1>count</span><span class=pl-c1>++</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-p5js-mp4-export-2-html-LC60" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-p5js-mp4-export-2-html-LC61" class="blob-code blob-code-inner js-file-line">            <span class=pl-c>// keep adding new frame</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-p5js-mp4-export-2-html-LC62" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>recording</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-p5js-mp4-export-2-html-LC63" class="blob-code blob-code-inner js-file-line">                <span class=pl-smi>console</span><span class=pl-kos>.</span><span class=pl-en>log</span><span class=pl-kos>(</span><span class=pl-s>&#39;recording&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-p5js-mp4-export-2-html-LC64" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>addFrameRgba</span><span class=pl-kos>(</span><span class=pl-s1>drawingContext</span><span class=pl-kos>.</span><span class=pl-en>getImageData</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-c1>0</span><span class=pl-kos>,</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>width</span><span class=pl-kos>,</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>height</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span class=pl-c1>data</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-p5js-mp4-export-2-html-LC65" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>recordedFrames</span><span class=pl-c1>++</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-p5js-mp4-export-2-html-LC66" class="blob-code blob-code-inner js-file-line">            <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-p5js-mp4-export-2-html-LC67" class="blob-code blob-code-inner js-file-line">            <span class=pl-c>// finalize encoding and export as mp4</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-p5js-mp4-export-2-html-LC68" class="blob-code blob-code-inner js-file-line">            <span class=pl-k>if</span> <span class=pl-kos>(</span><span class=pl-s1>recordedFrames</span> <span class=pl-c1>===</span> <span class=pl-s1>numFrames</span><span class=pl-kos>)</span> <span class=pl-kos>{</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-p5js-mp4-export-2-html-LC69" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>recording</span> <span class=pl-c1>=</span> <span class=pl-c1>false</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-p5js-mp4-export-2-html-LC70" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>recordedFrames</span> <span class=pl-c1>=</span> <span class=pl-c1>0</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-p5js-mp4-export-2-html-LC71" class="blob-code blob-code-inner js-file-line">                <span class=pl-smi>console</span><span class=pl-kos>.</span><span class=pl-en>log</span><span class=pl-kos>(</span><span class=pl-s>&#39;recording stopped&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-p5js-mp4-export-2-html-LC72" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-p5js-mp4-export-2-html-LC73" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>finalize</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-p5js-mp4-export-2-html-LC74" class="blob-code blob-code-inner js-file-line">                <span class=pl-k>const</span> <span class=pl-s1>uint8Array</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>FS</span><span class=pl-kos>.</span><span class=pl-en>readFile</span><span class=pl-kos>(</span><span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-p5js-mp4-export-2-html-LC75" class="blob-code blob-code-inner js-file-line">                <span class=pl-k>const</span> <span class=pl-s1>anchor</span> <span class=pl-c1>=</span> <span class=pl-smi>document</span><span class=pl-kos>.</span><span class=pl-en>createElement</span><span class=pl-kos>(</span><span class=pl-s>&#39;a&#39;</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-p5js-mp4-export-2-html-LC76" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>href</span> <span class=pl-c1>=</span> <span class=pl-c1>URL</span><span class=pl-kos>.</span><span class=pl-en>createObjectURL</span><span class=pl-kos>(</span><span class=pl-k>new</span> <span class=pl-v>Blob</span><span class=pl-kos>(</span><span class=pl-kos>[</span><span class=pl-s1>uint8Array</span><span class=pl-kos>]</span><span class=pl-kos>,</span> <span class=pl-kos>{</span> <span class=pl-c1>type</span>: <span class=pl-s>&#39;video/mp4&#39;</span> <span class=pl-kos>}</span><span class=pl-kos>)</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-p5js-mp4-export-2-html-LC77" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-c1>download</span> <span class=pl-c1>=</span> <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-c1>outputFilename</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-p5js-mp4-export-2-html-LC78" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>anchor</span><span class=pl-kos>.</span><span class=pl-en>click</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-p5js-mp4-export-2-html-LC79" class="blob-code blob-code-inner js-file-line">                <span class=pl-s1>encoder</span><span class=pl-kos>.</span><span class=pl-en>delete</span><span class=pl-kos>(</span><span class=pl-kos>)</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L80" class="blob-num js-line-number" data-line-number="80"></td>
        <td id="file-p5js-mp4-export-2-html-LC80" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L81" class="blob-num js-line-number" data-line-number="81"></td>
        <td id="file-p5js-mp4-export-2-html-LC81" class="blob-code blob-code-inner js-file-line">                <span class=pl-en>preload</span><span class=pl-kos>(</span><span class=pl-kos>)</span> <span class=pl-c>// reinitialize encoder</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L82" class="blob-num js-line-number" data-line-number="82"></td>
        <td id="file-p5js-mp4-export-2-html-LC82" class="blob-code blob-code-inner js-file-line">            <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L83" class="blob-num js-line-number" data-line-number="83"></td>
        <td id="file-p5js-mp4-export-2-html-LC83" class="blob-code blob-code-inner js-file-line">        <span class=pl-kos>}</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L84" class="blob-num js-line-number" data-line-number="84"></td>
        <td id="file-p5js-mp4-export-2-html-LC84" class="blob-code blob-code-inner js-file-line">    <span class=pl-kos>&lt;/</span><span class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L85" class="blob-num js-line-number" data-line-number="85"></td>
        <td id="file-p5js-mp4-export-2-html-LC85" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;/</span><span class=pl-ent>body</span><span class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L86" class="blob-num js-line-number" data-line-number="86"></td>
        <td id="file-p5js-mp4-export-2-html-LC86" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-p5js-mp4-export-2-html-L87" class="blob-num js-line-number" data-line-number="87"></td>
        <td id="file-p5js-mp4-export-2-html-LC87" class="blob-code blob-code-inner js-file-line"><span class=pl-kos>&lt;/</span><span class=pl-ent>html</span><span class=pl-kos>&gt;</span></td>
      </tr>
</table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/erraticgenerator/4e416428c1f04063ab6958afae11ff7b/raw/d0955c8b142275d218e717389d988bbd0c1d9138/p5js-mp4-export-2.html" style="float:right">view raw</a>
        <a href="https://gist.github.com/erraticgenerator/4e416428c1f04063ab6958afae11ff7b#file-p5js-mp4-export-2-html">p5js-mp4-export-2.html</a>
        hosted with &#10084; by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div></p>
<p>It’s just amazing to think about how much a web browser can do these days. And thanks to people who generously share these libraries, I can have more fun with coding. Here are some resources that I found useful:</p>
<ul>
<li>The original repo: <a href="https://github.com/TrevorSundberg/h264-mp4-encoder">https://github.com/TrevorSundberg/h264-mp4-encoder</a></li>
<li>Mattdesl’s fork: <a href="https://github.com/mattdesl/h264-mp4-encoder">https://github.com/mattdesl/h264-mp4-encoder</a> (I haven’t tried but it says it will be faster than the original)</li>
<li>An Observable notebook: <a href="https://observablehq.com/@rreusser/h264-mp4-encoder">https://observablehq.com/@rreusser/h264-mp4-encoder</a></li>
</ul></div><style data-emotion="css gi1u7h">.css-gi1u7h{margin-top:60px;padding:30px;border-top:1px solid #aaa;font-size:1.8rem;text-align:center;}</style><div class="css-gi1u7h"><style data-emotion="css 1l67l6w">.css-1l67l6w{margin-bottom:16px;color:#666;}</style><p class="css-1l67l6w">If you like my contents, please consider supporting my website. It helps me create more contents like this. Thank you!</p><a href="https://ko-fi.com/E1E12Z9TZ" target="_blank" rel="noreferrer" class="css-0"><img style="border:0;height:36px" src="https://cdn.ko-fi.com/cdn/kofi2.png?v=2" alt="Buy Me a Coffee at ko-fi.com"/></a></div></div></main><style data-emotion="css d9qqnj">.css-d9qqnj{grid-row:3/4;}</style><style data-emotion="css 1f21wwo">.css-1f21wwo{margin-top:48px;height:100px;background-image:linear-gradient(white 0%, #fdd 100%);}</style><footer class="css-1f21wwo"><style data-emotion="css ahgem5">.css-ahgem5{margin:0 auto;padding:0 12px;max-width:720px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-ahgem5"><style data-emotion="css 10r641u">.css-10r641u{font-size:1.2rem;}</style><div class="css-10r641u">Copyright 2020 • ErraticGenerator.com</div><style data-emotion="css 11f9kv5">.css-11f9kv5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:3rem;list-style-type:none;}.css-11f9kv5 li{margin:0 10px;}</style><ul class="css-11f9kv5"><li><a href="mailto:erraticgenerator@gmail.com" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></a></li><li><a href="https://instagram.com/erraticgenerator" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 306.9c-113.5 0-205.1 91.6-205.1 205.1S398.5 717.1 512 717.1 717.1 625.5 717.1 512 625.5 306.9 512 306.9zm0 338.4c-73.4 0-133.3-59.9-133.3-133.3S438.6 378.7 512 378.7 645.3 438.6 645.3 512 585.4 645.3 512 645.3zm213.5-394.6c-26.5 0-47.9 21.4-47.9 47.9s21.4 47.9 47.9 47.9 47.9-21.3 47.9-47.9a47.84 47.84 0 0 0-47.9-47.9zM911.8 512c0-55.2.5-109.9-2.6-165-3.1-64-17.7-120.8-64.5-167.6-46.9-46.9-103.6-61.4-167.6-64.5-55.2-3.1-109.9-2.6-165-2.6-55.2 0-109.9-.5-165 2.6-64 3.1-120.8 17.7-167.6 64.5C132.6 226.3 118.1 283 115 347c-3.1 55.2-2.6 109.9-2.6 165s-.5 109.9 2.6 165c3.1 64 17.7 120.8 64.5 167.6 46.9 46.9 103.6 61.4 167.6 64.5 55.2 3.1 109.9 2.6 165 2.6 55.2 0 109.9.5 165-2.6 64-3.1 120.8-17.7 167.6-64.5 46.9-46.9 61.4-103.6 64.5-167.6 3.2-55.1 2.6-109.8 2.6-165zm-88 235.8c-7.3 18.2-16.1 31.8-30.2 45.8-14.1 14.1-27.6 22.9-45.8 30.2C695.2 844.7 570.3 840 512 840c-58.3 0-183.3 4.7-235.9-16.1-18.2-7.3-31.8-16.1-45.8-30.2-14.1-14.1-22.9-27.6-30.2-45.8C179.3 695.2 184 570.3 184 512c0-58.3-4.7-183.3 16.1-235.9 7.3-18.2 16.1-31.8 30.2-45.8s27.6-22.9 45.8-30.2C328.7 179.3 453.7 184 512 184s183.3-4.7 235.9 16.1c18.2 7.3 31.8 16.1 45.8 30.2 14.1 14.1 22.9 27.6 30.2 45.8C844.7 328.7 840 453.7 840 512c0 58.3 4.7 183.2-16.2 235.8z"></path></svg></a></li><li><a href="https://erraticgenerator.medium.com" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M834.7 279.8l61.3-58.9V208H683.7L532.4 586.4 360.3 208H137.7v12.9l71.6 86.6c7 6.4 10.6 15.8 9.7 25.2V673c2.2 12.3-1.7 24.8-10.3 33.7L128 805v12.7h228.6v-12.9l-80.6-98a39.99 39.99 0 0 1-11.1-33.7V378.7l200.7 439.2h23.3l172.6-439.2v349.9c0 9.2 0 11.1-6 17.2l-62.1 60.3V819h301.2v-12.9l-59.9-58.9c-5.2-4-7.9-10.7-6.8-17.2V297a18.1 18.1 0 0 1 6.8-17.2z"></path></svg></a></li><li><a href="https://twitter.com/erraticgener8or" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 254.3c-30.6 13.2-63.9 22.7-98.2 26.4a170.1 170.1 0 0 0 75-94 336.64 336.64 0 0 1-108.2 41.2A170.1 170.1 0 0 0 672 174c-94.5 0-170.5 76.6-170.5 170.6 0 13.2 1.6 26.4 4.2 39.1-141.5-7.4-267.7-75-351.6-178.5a169.32 169.32 0 0 0-23.2 86.1c0 59.2 30.1 111.4 76 142.1a172 172 0 0 1-77.1-21.7v2.1c0 82.9 58.6 151.6 136.7 167.4a180.6 180.6 0 0 1-44.9 5.8c-11.1 0-21.6-1.1-32.2-2.6C211 652 273.9 701.1 348.8 702.7c-58.6 45.9-132 72.9-211.7 72.9-14.3 0-27.5-.5-41.2-2.1C171.5 822 261.2 850 357.8 850 671.4 850 843 590.2 843 364.7c0-7.4 0-14.8-.5-22.2 33.2-24.3 62.3-54.4 85.5-88.2z"></path></svg></a></li></ul></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-185826355-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-185826355-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/video-export-from-p5js-sketch";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-303683f6c6a5fb752dca.js"],"app":["/app-17076851edb603384cdc.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6dc904ca7e4ab4ede6c1.js"],"component---src-pages-about-js":["/component---src-pages-about-js-1e5b2148c2017e410e3a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-775a7ece3eb7b23ec1d1.js"],"component---src-templates-blog-post-template-js":["/component---src-templates-blog-post-template-js-0b42d03e1b5cb581436d.js"]};/*]]>*/</script><script src="/polyfill-303683f6c6a5fb752dca.js" nomodule=""></script><script src="/component---src-templates-blog-post-template-js-0b42d03e1b5cb581436d.js" async=""></script><script src="/77e824346eb342330b3ba237752743d1d190a1c1-44e23925d079bc9c8bd0.js" async=""></script><script src="/commons-b8d2d0e6cd0acc8389b5.js" async=""></script><script src="/styles-7d4153d260c0197f0043.js" async=""></script><script src="/app-17076851edb603384cdc.js" async=""></script><script src="/framework-de237a875aa45b276a9d.js" async=""></script><script src="/webpack-runtime-3d855f313f7e8d8d5126.js" async=""></script></body></html>